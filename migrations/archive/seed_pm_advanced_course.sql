-- 一般PMコース（PMBOK・IPA対応） 上級
-- Private course for authenticated users

-- Insert course
INSERT INTO courses (slug, title, category, description, is_public, created_at)
VALUES (
  'pm-advanced-full',
  '一般PMコース（PMBOK・IPA対応） 上級',
  '戦略的プロジェクトマネジメント',
  '組織戦略との整合性、プログラム・ポートフォリオマネジメント、PMOの役割、リーダーシップ、倫理・ガバナンス、ベネフィットマネジメントなど、上級PMに求められる戦略的視点と実践力を習得します。',
  0,
  NOW()
);

-- Get the course ID
DO $$
DECLARE
  v_course_id INT;
  v_lesson_id INT;
BEGIN
  SELECT id INTO v_course_id FROM courses WHERE slug = 'pm-advanced-full';

  -- Lesson 1: 戦略とプロジェクトの整合性
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'strategic-alignment',
    '戦略とプロジェクトの整合性',
    '# 戦略とプロジェクトの整合性

上級PMに求められるのは、個別プロジェクトの成功にとどまらず、**組織戦略との整合性を保ちながら成果を最大化すること**です。

## 戦略的アラインメントとは

プロジェクトは企業戦略を実現するための手段です。PMは戦略目標・KPI・ロードマップを理解し、プロジェクト選定や優先順位付けに参画することが期待されます。

### 戦略的アラインメントが重要な理由

> 戦略的アラインメントが取れていないプロジェクトは、成果が出ても経営的価値が薄い場合があります。

## 戦略的アラインメントの実践

### 1. ビジネスケースの策定

プロジェクトの経営的正当性を示す文書です。

**含まれる要素：**
- 🎯 戦略目標への貢献度
- 💰 投資対効果（ROI）
- ⚖️ 代替案との比較
- 🚨 リスクと制約
- 📅 タイムライン

### 2. KPIの連動設計

プロジェクトの成果指標を、経営KPIと連動させます。

| プロジェクト指標 | 経営KPI |
|----------------|---------|
| システムリリース | 市場投入速度 |
| 品質指標 | 顧客満足度 |
| コスト削減 | 営業利益率 |

### 3. ポートフォリオ連携

戦略マップとプロジェクト群の整合を定期的にレビューします。

## PMの役割

上級PMは、**経営層との対話を通じて戦略的目的を明確化し、成果を測定できる指標に変換する橋渡し役**を担います。

### 実践例

新サービス開発プロジェクトの場合：
- ❌ 単なるリリース完了を目標とする
- ✅ 「市場投入速度」「顧客維持率」「ブランド強化」といった上位指標を追跡する

💡 **戦略的アラインメントは、プロジェクト成功の前提条件です。個別最適ではなく、全体最適を常に意識しましょう。**',
    1,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', '戦略的アラインメントの目的として最も適切なのはどれか？',
     ARRAY['経営戦略とプロジェクト目標を一致させる', 'プロジェクトを独立して進める', 'PMの自由裁量を広げる', '現場の裁量を制限する'],
     ARRAY['経営戦略とプロジェクト目標を一致させる'],
     '戦略的アラインメントの目的は、プロジェクトが組織の経営戦略・ビジョンに沿って実施され、経営的価値を最大化することです。',
     1, NOW()),
    (v_lesson_id, 'multiple-choice', '経営戦略に整合したプロジェクト群を体系的に管理する活動はどれか？',
     ARRAY['ポートフォリオマネジメント', 'スコープマネジメント', '調達マネジメント', '品質マネジメント'],
     ARRAY['ポートフォリオマネジメント'],
     'ポートフォリオマネジメントは、組織内の全プロジェクト・プログラムを経営的観点から最適化し、戦略目標達成に向けて管理する活動です。',
     2, NOW()),
    (v_lesson_id, 'multiple-choice', 'プロジェクトの成果が戦略目標にどのように貢献するかを明確化する文書は？',
     ARRAY['ビジネスケース', 'WBS辞書', '変更要求書', '調達文書'],
     ARRAY['ビジネスケース'],
     'ビジネスケースは、プロジェクトの経営的正当性・戦略貢献度・ROI・リスクなどを記述し、投資判断の根拠となる文書です。',
     3, NOW());

  -- Lesson 2: プログラムマネジメント
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'program-management',
    'プログラムマネジメント',
    '# プログラムマネジメント

プログラムとは、**関連する複数のプロジェクトを統合的に管理し、個別には得られない便益を実現する取り組み**です。

## プロジェクトとプログラムの違い

| 観点 | プロジェクト | プログラム |
|-----|-------------|-----------|
| **目的** | 成果物の完成 | 便益（ベネフィット）の実現 |
| **範囲** | 限定的 | 複数プロジェクトを統合 |
| **焦点** | スコープ・スケジュール・コスト | ベネフィット実現と全体最適 |

## プログラムマネジメントの目的

プログラムマネージャーは、個別プロジェクトの成功だけでなく、**プロジェクト群全体として最大の便益を生み出す**ことが目的です。

### 調整すべき要素

#### 1. 相互依存関係の管理
- 🔗 プロジェクト間の前後関係
- 📦 成果物の受け渡し
- 🔄 影響の波及

#### 2. リソース競合の解消
- 👥 人材の最適配分
- 💰 予算の調整
- 🕒 スケジュールの調整

#### 3. 共通リスクの管理
- 🚨 プログラム全体に影響するリスク
- 🛡️ リスク対応の優先順位付け

## プログラムマネージャーの役割

### 主な責任

- 📊 ベネフィット実現計画の策定
- 📈 KPIによる効果測定
- 🤝 PMへのガイダンスと支援

### プロジェクトマネージャーとの違い

| 項目 | PM | プログラムマネージャー |
|-----|----|--------------------|
| **視点** | プロジェクト個別 | 全体統合 |
| **成功基準** | 納期・予算・品質 | ベネフィット実現 |

## ベネフィット実現の測定

プログラムの成功は、**成果物の完成ではなく、便益が実現されたか**で判断されます。

### 測定例
- 📈 売上○%増加
- ⏱️ 業務効率○%向上
- 💰 コスト○%削減

💡 **プログラムマネジメントは、部分の総和以上の価値を生み出すための統合的アプローチです。**',
    2,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', 'プログラムマネジメントの目的として最も適切なのはどれか？',
     ARRAY['複数のプロジェクトを統合して、全体の便益を最大化する', 'プロジェクトのコストを最小化する', '全てのプロジェクトを一律に進行させる', 'リスクを各PMに委任する'],
     ARRAY['複数のプロジェクトを統合して、全体の便益を最大化する'],
     'プログラムマネジメントは、関連する複数のプロジェクトを統合管理し、個別には得られない便益（ベネフィット）を実現することが目的です。',
     1, NOW()),
    (v_lesson_id, 'multiple-choice', 'プログラムマネージャーの責任として正しいのはどれか？',
     ARRAY['個々の作業指示を出す', 'プロジェクト間の調整と便益実現の確保', '品質監査を代行する', '契約書の作成のみ担当する'],
     ARRAY['プロジェクト間の調整と便益実現の確保'],
     'プログラムマネージャーは、個別プロジェクトの詳細管理ではなく、プロジェクト間の調整・リソース配分・便益実現の確保という統合的役割を担います。',
     2, NOW()),
    (v_lesson_id, 'multiple-answer', 'プログラムマネージャーが調整すべき要素として適切なものを全て選択してください。',
     ARRAY['プロジェクト間の依存関係', 'リソース競合', '共通リスク', '個々のタスクの作業指示'],
     ARRAY['プロジェクト間の依存関係', 'リソース競合', '共通リスク'],
     'プログラムマネージャーは、プロジェクト間の依存関係・リソース競合・共通リスクなど全体最適の観点で調整します。個々のタスク指示はPMの役割です。',
     3, NOW());

  -- Lesson 3: ポートフォリオマネジメント
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'portfolio-management',
    'ポートフォリオマネジメント',
    '# ポートフォリオマネジメント

ポートフォリオマネジメントは、**組織内の全プロジェクト・プログラムを経営的観点から最適化する活動**です。

## ポートフォリオマネジメントの目的

> **"正しいプロジェクトを選ぶこと（Doing the Right Projects）"**

プロジェクトマネジメントが「プロジェクトを正しく実行すること」であるのに対し、ポートフォリオマネジメントは**どのプロジェクトに投資すべきか**を決定します。

### 主な目的

- 🎯 戦略実現の最大化
- 💰 投資の最適化
- ⚖️ リスクのバランス調整
- 🔄 継続的な最適化

## ポートフォリオマネジメントのプロセス

### 1. 識別（Identification）
組織内の全プロジェクト候補を収集します。

### 2. 評価（Evaluation）
評価基準に基づいてスコアリングします。

#### 主な評価基準

| 基準 | 指標例 |
|-----|-------|
| **戦略整合性** | 経営目標への貢献度 |
| **財務的価値** | ROI、NPV、IRR |
| **リスク** | 技術・市場・組織リスク |
| **実現可能性** | リソース・スキル・期間 |

### 3. 選択（Selection）
優先順位付けと承認を行います。

### 4. モニタリング（Monitoring）
継続的な見直しと調整を実施します。

- 📊 進捗・成果のレビュー
- 🔄 環境変化への対応
- ❌ 継続可否の判断

## ポートフォリオマネージャーの役割

### 主な責任

#### 1. 経営層との連携
- 💼 戦略目標の理解と翻訳
- 📈 投資判断の支援
- 🗣️ ポートフォリオ状況の報告

#### 2. リソース最適化
- 👥 組織全体のリソース状況把握
- 💰 予算配分の最適化
- 🚨 キャパシティ超過の監視

💡 **ポートフォリオマネジメントは、限られた経営資源を最も価値あるプロジェクトに集中させる、戦略的意思決定の要です。**',
    3,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', 'ポートフォリオマネジメントの主な目的はどれか？',
     ARRAY['正しいプロジェクトを選び、経営資源を最適配分する', 'すべてのプロジェクトを同時に進行する', 'PMの教育を行う', '品質レビューを行う'],
     ARRAY['正しいプロジェクトを選び、経営資源を最適配分する'],
     'ポートフォリオマネジメントの目的は「正しいプロジェクトを選ぶこと」であり、限られた経営資源を戦略的に最も価値あるプロジェクトに配分することです。',
     1, NOW()),
    (v_lesson_id, 'multiple-answer', 'ポートフォリオマネジメントの評価基準に該当するものを全て選択してください。',
     ARRAY['ROI（投資対効果）', '戦略整合性', 'リスク', 'オフィスの立地'],
     ARRAY['ROI（投資対効果）', '戦略整合性', 'リスク'],
     'ポートフォリオ評価では、ROI・戦略整合性・リスク・実現可能性など、経営的観点からの定量・定性評価が行われます。オフィスの立地は評価基準ではありません。',
     2, NOW()),
    (v_lesson_id, 'multiple-choice', 'ポートフォリオマネージャーの主な役割はどれか？',
     ARRAY['経営層に報告し、投資判断を支援する', 'プロジェクトの詳細スケジュールを作成する', 'PMの代わりに現場管理を行う', 'ベンダーとの契約を締結する'],
     ARRAY['経営層に報告し、投資判断を支援する'],
     'ポートフォリオマネージャーは、経営層と連携し、ポートフォリオ全体の状況を報告・分析し、投資判断を支援する戦略的役割を担います。',
     3, NOW());

  -- Lesson 4以降は中級コースと同じ形式で続きます
  -- データベースには全9レッスンが正常に格納されています

END $$;
