-- 一般PMコース（PMBOK・IPA対応） 中級
-- Private course for authenticated users

-- Insert course
INSERT INTO courses (slug, title, category, description, is_public, created_at)
VALUES (
  'pm-intermediate',
  '一般PMコース（PMBOK・IPA対応） 中級',
  'プロジェクトマネジメント実践',
  'PMBOKの各知識エリアを実践レベルで学習するコースです。統合マネジメント、品質・コスト管理、リスク分析、調達・変更管理など、実務で即活用できる知識とスキルを習得します。',
  0,
  NOW()
);

-- Get the course ID
DO $$
DECLARE
  v_course_id INT;
  v_lesson_id INT;
BEGIN
  SELECT id INTO v_course_id FROM courses WHERE slug = 'pm-intermediate';

  -- Lesson 1: 統合マネジメントの実践
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'integration-management',
    '統合マネジメントの実践',
    '# 統合マネジメントの実践

統合マネジメントは、**プロジェクト全体を一貫して整合させる中核的プロセス**です。

## 統合マネジメントの役割

PMは各知識エリア（スコープ、スケジュール、コスト、品質、リスクなど）の出力を調整し、**プロジェクト全体を最適化**する役割を担います。

### 主なプロセス

#### 1. プロジェクトマネジメント計画書の作成
各知識エリアの計画を統合した包括的な文書

**含まれる内容：**
- 📋 スコープマネジメント計画
- ⏱️ スケジュールマネジメント計画
- 💰 コストマネジメント計画
- ⚡ 品質マネジメント計画
- 🚨 リスクマネジメント計画
- 👥 資源マネジメント計画
- 💬 コミュニケーションマネジメント計画
- 🤝 ステークホルダーマネジメント計画

#### 2. プロジェクト作業の指揮・マネジメント
計画に基づいて作業を遂行し、成果物を生み出す

#### 3. プロジェクト知識のマネジメント
組織の知見を活用し、新たな知識を蓄積する

#### 4. 統合変更管理
変更要求を評価・承認し、計画に反映させる

#### 5. プロジェクトやフェーズの終結
正式な完了手続きと教訓の整理

## 統合変更管理プロセス

変更要求を受けた際、PMは以下を実施します：

### 影響分析
| 評価項目 | 確認内容 |
|---------|---------|
| **スコープ** | 作業範囲はどう変わるか |
| **スケジュール** | 納期への影響は |
| **コスト** | 予算への影響は |
| **品質** | 品質基準への影響は |
| **リスク** | 新たなリスクは発生するか |

### 変更管理委員会（CCB）での承認
- ✅ 影響評価結果を提示
- ✅ ステークホルダーの合意形成
- ✅ 承認された変更のみ実行

### 計画の更新と周知
- 📄 関連文書の更新
- 📢 チームへの変更内容の伝達
- 📊 ベースラインの再設定（必要に応じて）

## ナレッジマネジメント

**目的：** 組織内の知識を蓄積・共有し、将来のプロジェクトに活かす

### 活動内容
- 💡 過去のプロジェクトから学ぶ
- 📚 ベストプラクティスの文書化
- 🔄 教訓の継続的な更新
- 🌐 組織横断での知識共有

💡 **統合マネジメントは、個別の知識エリアをつなぎ、プロジェクト全体の成功を導く要です。**',
    1,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', '統合変更管理の主な目的はどれか？',
     ARRAY['すべての変更要求を自動的に承認するため', '変更の影響を評価し、承認された変更のみを反映するため', 'プロジェクト計画を頻繁に書き換えるため', 'ステークホルダー全員の同意を省略するため'],
     ARRAY['変更の影響を評価し、承認された変更のみを反映するため'],
     '統合変更管理は、変更要求の影響を評価し、CCB（変更管理委員会）で承認された変更のみをプロジェクトに反映します。無秩序な変更はプロジェクトの混乱を招きます。',
     1, NOW()),
    (v_lesson_id, 'multiple-answer', 'プロジェクトマネジメント計画書に含まれるものを全て選択してください。',
     ARRAY['スコープマネジメント計画', '品質マネジメント計画', '日報フォーマット', 'リスクマネジメント計画'],
     ARRAY['スコープマネジメント計画', '品質マネジメント計画', 'リスクマネジメント計画'],
     'プロジェクトマネジメント計画書は、各知識エリアの計画を統合した文書です。日報フォーマットは運用レベルの文書であり、計画書には含まれません。',
     2, NOW()),
    (v_lesson_id, 'multiple-choice', 'ナレッジマネジメント活動の目的は何か？',
     ARRAY['組織内の知識を蓄積・共有し、将来のプロジェクトに活かす', '外部への情報流出を防ぐ', 'ドキュメント数を減らす', '監査対応のためにのみ記録する'],
     ARRAY['組織内の知識を蓄積・共有し、将来のプロジェクトに活かす'],
     'ナレッジマネジメントは、組織の知的資産を蓄積し、過去の成功・失敗から学び、将来のプロジェクトの成功確率を高めることが目的です。',
     3, NOW());

  -- Lesson 2: ステークホルダーマネジメント
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'stakeholder-management-advanced',
    'ステークホルダーマネジメント',
    '# ステークホルダーマネジメント

プロジェクトの成功には、**利害関係者（ステークホルダー）との良好な関係構築**が不可欠です。

## ステークホルダーの特定と分析

### ステークホルダーとは

プロジェクトに対して：
- 🎯 **影響を与える人・組織**：スポンサー、意思決定者、チームメンバー
- 📢 **影響を受ける人・組織**：エンドユーザー、顧客、地域住民

## 権力・関心マトリクス

ステークホルダーを**権力（影響力）**と**関心度**で分類

| 関心度 ＼ 権力 | 低権力 | 高権力 |
|--------------|--------|--------|
| **高関心** | 🟦 情報提供 | 🟥 重点的に管理 |
| **低関心** | 🟩 監視 | 🟨 満足させる |

### 対応戦略

#### 🟥 重点的に管理（高権力 × 高関心）
- ✅ 定期的なコミュニケーション
- ✅ 意思決定への参加を促す
- ✅ 懸念事項への迅速な対応
- ✅ 期待値の綿密な管理

**例：** プロジェクトスポンサー、主要顧客

#### 🟨 満足させる（高権力 × 低関心）
- ✅ 定期的な報告
- ✅ 重要な決定事項の共有
- ✅ 過度な負担をかけない
- ⚠️ 急に関心が高まる可能性に注意

**例：** 経営層、部門長

#### 🟦 情報提供（低権力 × 高関心）
- ✅ 適切な情報提供
- ✅ 期待値の管理
- ✅ フィードバックの収集
- ✅ 味方にする工夫

**例：** エンドユーザー、サポート部門

#### 🟩 監視（低権力 × 低関心）
- ✅ 最小限の対応
- ✅ 状況変化の監視
- ⚠️ 後で重要になる可能性も

## 関与マネジメント計画

**目的：** ステークホルダーごとに適切な関与方法を定義する

### 計画に含める内容

| 項目 | 内容 |
|------|------|
| **関与レベル** | 現状と望ましい状態のギャップ |
| **コミュニケーション方法** | 会議、メール、報告書など |
| **頻度** | 毎週、マイルストーンごとなど |
| **責任者** | 誰が対応するか |

### 関与度の5段階

1. **無関心（Unaware）** - プロジェクトを知らない
2. **抵抗（Resistant）** - プロジェクトに反対
3. **中立（Neutral）** - 賛成も反対もしない
4. **支援（Supportive）** - プロジェクトを支援
5. **主導（Leading）** - 積極的に関与

💡 **PMは、ステークホルダーを望ましい関与レベルに導く戦略を立てます。**

## 関与を高める方法

### 効果的なアプローチ
- 👂 定期的に意見を聴取する
- 📊 期待と実際の差を把握する
- 🎯 個別の関心事に対応する
- 🏆 貢献を認め、感謝を示す

### 避けるべき行動
- ❌ 一方的な報告のみ
- ❌ 変更を伝えない
- ❌ 問題発生時にのみ連絡
- ❌ 意見を聞かない',
    2,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', 'ステークホルダー分析で用いられる代表的なツールはどれか？',
     ARRAY['リスクマトリクス', '権力・関心マトリクス', 'SWOT分析', 'PERT図'],
     ARRAY['権力・関心マトリクス'],
     '権力・関心マトリクスは、ステークホルダーを権力（影響力）と関心度で分類し、適切な対応戦略を定めるツールです。',
     1, NOW()),
    (v_lesson_id, 'multiple-choice', '関与マネジメント計画の目的はどれか？',
     ARRAY['すべてのステークホルダーを同等に扱うため', 'ステークホルダーごとに適切な関与方法を定義するため', 'PMの裁量で判断を省略するため', '報告書作成の手間を省くため'],
     ARRAY['ステークホルダーごとに適切な関与方法を定義するため'],
     '関与マネジメント計画は、ステークホルダーの特性に応じて、コミュニケーション方法や頻度を個別に定義します。一律の対応では効果的な関係構築はできません。',
     2, NOW()),
    (v_lesson_id, 'multiple-answer', 'ステークホルダーの関与を高める有効な方法を全て選択してください。',
     ARRAY['定期的に意見を聴取する', '期待と実際の差を把握する', '変更を伝えない', '一方的な報告のみ行う'],
     ARRAY['定期的に意見を聴取する', '期待と実際の差を把握する'],
     '関与を高めるには、双方向のコミュニケーションが重要です。意見聴取と期待値管理により、ステークホルダーの満足度と関与度を向上させます。',
     3, NOW());

  -- Lesson 3: 品質マネジメントの実践
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'quality-management',
    '品質マネジメントの実践',
    '# 品質マネジメントの実践

品質マネジメントは、**要求事項への適合を確保する**ための活動です。

## 品質の定義

プロジェクトにおける品質とは：
- ✅ **要求事項への適合度**
- ✅ **目的への適合性（Fitness for Use）**

❌ 高級・高性能 ≠ 品質

💡 **必要十分な品質を、計画通りに達成することが重要です。**

## 品質マネジメントの3つのプロセス

### 1. 品質マネジメント計画
品質基準と品質保証・コントロールの方法を定義

**定義する内容：**
- 品質目標・基準
- 品質メトリクス（測定指標）
- 品質保証活動
- 品質コントロール手法

### 2. 品質マネジメント（品質保証 - QA）
**目的：** プロセスを改善して欠陥の発生を防ぐ

**活動内容：**
- ✅ プロセスの監査
- ✅ 標準の遵守確認
- ✅ 継続的改善
- ✅ ベストプラクティスの適用

💡 **「予防」の考え方 - 問題が起きる前に対処**

### 3. 品質コントロール（QC）
**目的：** 成果物が基準を満たしているか検証

**活動内容：**
- 🔍 検査・レビュー
- 📊 統計的手法の活用
- 🔄 不適合の是正
- 📈 品質データの分析

## 品質コストの考え方

| コスト種別 | 内容 | 例 |
|-----------|------|-----|
| **適合のためのコスト** | 品質を確保するための費用 | 検査、レビュー、教育訓練 |
| **不適合のコスト** | 欠陥によって発生する費用 | 再作業、苦情対応、保証費用 |

💡 **適合のためのコストに投資することで、不適合のコストを削減できます。**

## 品質管理の7つ道具

### 1. フィッシュボーン図（特性要因図）
問題の原因を体系的に分析

### 2. パレート図
重要な問題を優先順位づけ（80/20の法則）

### 3. ヒストグラム
データの分布を視覚化

### 4. 管理図
プロセスの安定性を監視

### 5. チェックシート
データ収集を効率化

### 6. 散布図
2つの変数の相関を分析

### 7. 層別
データをグループ分けして分析

## 継続的改善（PDCA）

品質向上のための基本サイクル

```
Plan（計画）
  ↓
Do（実行）
  ↓
Check（評価）
  ↓
Act（改善）
  ↓
（繰り返し）
```

💡 **品質は一度達成すれば終わりではなく、継続的な改善が必要です。**',
    3,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', '品質保証（QA）の目的はどれか？',
     ARRAY['完成品の欠陥を後で修正する', 'プロセスを改善して欠陥の発生を防ぐ', '製品テストを減らす', '納期を短縮する'],
     ARRAY['プロセスを改善して欠陥の発生を防ぐ'],
     '品質保証（QA）は「予防」の考え方に基づき、プロセスを改善することで欠陥の発生を未然に防ぎます。欠陥の修正は品質コントロール（QC）の役割です。',
     1, NOW()),
    (v_lesson_id, 'multiple-choice', '品質コントロールで使用される代表的な手法はどれか？',
     ARRAY['フィッシュボーン図（特性要因図）', 'PERT図', 'WBS分解', 'EVM分析'],
     ARRAY['フィッシュボーン図（特性要因図）'],
     'フィッシュボーン図（特性要因図）は、品質問題の原因を体系的に分析するための代表的なツールです。PERT図はスケジュール管理、EVMはコスト管理のツールです。',
     2, NOW()),
    (v_lesson_id, 'multiple-answer', '適合のためのコストに該当するものを全て選択してください。',
     ARRAY['検査コスト', '教育訓練コスト', '再作業コスト', '苦情対応コスト'],
     ARRAY['検査コスト', '教育訓練コスト'],
     '適合のためのコストは、品質を確保するための予防的な費用です。再作業や苦情対応は、不適合のコスト（欠陥によって発生する費用）に分類されます。',
     3, NOW());

  -- Lesson 4: コストマネジメント
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'cost-management',
    'コストマネジメント',
    '# コストマネジメント

コストマネジメントは、**予算内でプロジェクトを完了させる**ための活動です。

## コストマネジメントのプロセス

### 1. コスト見積もり
各作業に必要なコストを算出

**見積もり手法：**
- 📊 類推見積もり（過去の類似プロジェクトから）
- 🔢 パラメトリック見積もり（統計モデル使用）
- 📝 ボトムアップ見積もり（詳細積み上げ）
- 💡 三点見積もり（楽観値・最頻値・悲観値）

### 2. 予算設定
見積もりを集約し、タイムフェーズ予算を作成

### 3. コストコントロール
実績を監視し、差異を管理

## EVM（アーンド・バリュー・マネジメント）

**コストと進捗を統合的に評価する手法**

### 3つの基本指標

| 指標 | 意味 | 説明 |
|------|------|------|
| **PV** (Planned Value) | 計画価値 | この時点で達成しているべき作業の予算価値 |
| **EV** (Earned Value) | 出来高 | 実際に完了した作業の予算価値 |
| **AC** (Actual Cost) | 実コスト | 実際に支出した金額 |

### 差異分析

#### コスト差異（CV: Cost Variance）
**CV = EV - AC**

- CV > 0 → ✅ 予算内に収まっている
- CV = 0 → ✅ 予算通り
- CV < 0 → ❌ 予算超過

#### スケジュール差異（SV: Schedule Variance）
**SV = EV - PV**

- SV > 0 → ✅ 進んでいる
- SV = 0 → ✅ 予定通り
- SV < 0 → ❌ 遅れている

### パフォーマンス指数

#### CPI（コスト効率指数）
**CPI = EV / AC**

- CPI > 1 → ✅ 効率的（1円あたりの成果が高い）
- CPI = 1 → ✅ 計画通り
- CPI < 1 → ❌ 非効率（コスト超過）

#### SPI（スケジュール効率指数）
**SPI = EV / PV**

- SPI > 1 → ✅ 進んでいる
- SPI = 1 → ✅ 予定通り
- SPI < 1 → ❌ 遅れている

## 完成時総コスト予測

### EAC（Estimate at Completion）
プロジェクト完了時の総コスト予測

**計算式（現在の効率が続くと仮定）：**
**EAC = BAC / CPI**

- BAC: Budget at Completion（完了時総予算）

### ETC（Estimate to Complete）
残作業に必要なコスト

**ETC = EAC - AC**

### VAC（Variance at Completion）
完了時の予算差異

**VAC = BAC - EAC**

- VAC > 0 → ✅ 予算内で完了予定
- VAC < 0 → ❌ 予算超過予定

## EVMの活用例

**プロジェクト状況：**
- BAC = 1,000万円
- PV = 500万円
- EV = 400万円
- AC = 450万円

**分析結果：**
- CV = 400 - 450 = -50万円 ❌ 予算超過
- SV = 400 - 500 = -100万円 ❌ 遅延
- CPI = 400 / 450 = 0.89 ❌ 非効率
- SPI = 400 / 500 = 0.80 ❌ 遅れている

**予測：**
- EAC = 1,000 / 0.89 = 1,124万円
- VAC = 1,000 - 1,124 = -124万円 ❌ 完了時124万円超過予定

💡 **EVMにより、プロジェクトの健全性を定量的に把握し、早期に対策を講じることができます。**',
    4,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', 'EVM分析で『EV（Earned Value）』が意味するものはどれか？',
     ARRAY['完了した作業の価値（予算換算）', '実際に支出した金額', '計画された作業の予算', 'コストの総額'],
     ARRAY['完了した作業の価値（予算換算）'],
     'EV（Earned Value：出来高）は、実際に完了した作業の予算価値を表します。「いくら使ったか」ではなく「どれだけ進んだか」を予算換算した値です。',
     1, NOW()),
    (v_lesson_id, 'multiple-choice', 'CPI（コスト効率指数）が1未満の場合、どのような状況を示すか？',
     ARRAY['コストが計画より効率的に使用されている', 'コストが計画より多く消費されている', 'スケジュールが前倒しで進んでいる', 'プロジェクトが終了している'],
     ARRAY['コストが計画より多く消費されている'],
     'CPI = EV / AC であり、1未満ということは分母（実コスト）が分子（出来高）より大きい、つまりコストが予定より多く消費されている状態です。',
     2, NOW()),
    (v_lesson_id, 'multiple-answer', 'EVMで使用される基本指標を全て選択してください。',
     ARRAY['PV（計画価値）', 'EV（出来高）', 'AC（実コスト）', 'WBS（作業分解図）'],
     ARRAY['PV（計画価値）', 'EV（出来高）', 'AC（実コスト）'],
     'EVMの3つの基本指標は、PV（計画価値）、EV（出来高）、AC（実コスト）です。WBSは作業分解構成図であり、EVMの指標ではありません。',
     3, NOW());

  -- Lesson 5: リスク分析と対応計画
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'risk-analysis',
    'リスク分析と対応計画',
    '# リスク分析と対応計画

中級レベルでは、**定性的分析と定量的分析**の違いを理解し、使い分けることが重要です。

## リスクマネジメントプロセス

### 1. リスクの特定
### 2. リスク分析
  - 定性的リスク分析
  - 定量的リスク分析
### 3. リスク対応計画
### 4. リスク対応策の実行
### 5. リスクの監視

## 定性的リスク分析

**目的：** 発生確率と影響度をもとに優先順位を設定

### リスク確率・影響マトリクス

| 影響度 ＼ 確率 | 低 | 中 | 高 |
|--------------|----|----|-----|
| **大** | 🟨 中 | 🟧 高 | 🟥 最高 |
| **中** | 🟩 低 | 🟨 中 | 🟧 高 |
| **小** | 🟩 低 | 🟩 低 | 🟨 中 |

**優先順位：**
- 🟥 最高：最優先で対応
- 🟧 高：重要、対応を計画
- 🟨 中：監視が必要
- 🟩 低：受容可能

### 評価基準の例

#### 発生確率
- 高：50%以上
- 中：20～50%
- 低：20%未満

#### 影響度（コストへの影響例）
- 大：予算の10%以上
- 中：予算の5～10%
- 小：予算の5%未満

## 定量的リスク分析

**目的：** リスクの数値的影響を分析する

### 主な手法

#### 1. 期待金額価値（EMV）分析
**EMV = 発生確率 × 影響額**

**例：**
- リスクA：発生確率30%、影響額-100万円
  - EMV = 0.3 × (-100万円) = -30万円

#### 2. モンテカルロシミュレーション
多数の試行をシミュレートして全体リスクを評価

**活用場面：**
- 💰 プロジェクト完了時のコスト予測
- ⏱️ プロジェクト完了時期の予測
- 📊 目標達成確率の算出

**出力例：**
- 予算1,000万円で完了する確率：65%
- 1,100万円で完了する確率：90%

#### 3. デシジョンツリー分析
意思決定の選択肢とその結果を樹形図で評価

## リスク対応戦略（再確認）

### 1. 回避（Avoid）
リスクを完全に排除

**例：**
- ❌ 不確実性の高い技術を使わない
- ❌ リスクの高いベンダーを選定しない

### 2. 転嫁（Transfer）
リスクの責任を第三者に移す

**例：**
- 🏢 保険に加入
- 📝 固定価格契約で外注
- 🤝 保証条項を契約に含める

### 3. 軽減（Mitigate）
発生確率または影響度を減らす

**例：**
- 🧪 プロトタイプで検証
- 👨‍🏫 事前トレーニング
- 🔄 バックアップ体制構築

### 4. 受容（Accept）
対策を講じず、発生したら対処

#### 能動的受容
- 💰 コンティンジェンシー予備（予備費）確保
- 📋 対応手順の準備

#### 受動的受容
- 何もしない（影響が小さい場合）

## リスク登録簿の管理

継続的に更新し、リスクの状態を追跡

| 項目 | 内容 |
|------|------|
| リスクID | 識別番号 |
| リスク内容 | 具体的な記述 |
| カテゴリ | 技術、組織、外部など |
| 発生確率 | 高・中・低 |
| 影響度 | 大・中・小 |
| 優先度 | 確率×影響度 |
| 対応策 | 回避・転嫁・軽減・受容 |
| 担当者 | 監視責任者 |
| ステータス | 発生前・発生・解決 |

💡 **定性分析で優先順位をつけ、重要なリスクには定量分析を適用します。**',
    5,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', '定性的リスク分析でよく用いられるツールはどれか？',
     ARRAY['リスク確率・影響マトリクス', 'EVMチャート', 'パレート図', 'PERT分析'],
     ARRAY['リスク確率・影響マトリクス'],
     '定性的リスク分析では、リスク確率・影響マトリクスを用いて、発生確率と影響度をもとにリスクの優先順位を設定します。',
     1, NOW()),
    (v_lesson_id, 'multiple-choice', 'モンテカルロシミュレーションの目的は何か？',
     ARRAY['リスクの数値的影響を分析する', '品質を測定する', 'コスト見積もりを自動化する', 'ステークホルダー分析を行う'],
     ARRAY['リスクの数値的影響を分析する'],
     'モンテカルロシミュレーションは、多数の試行をシミュレートして、プロジェクトの完了時期やコストの予測分布を求める定量的分析手法です。',
     2, NOW()),
    (v_lesson_id, 'multiple-answer', 'リスク対応策として正しいものを全て選択してください。',
     ARRAY['回避', '転嫁', '軽減', '無視'],
     ARRAY['回避', '転嫁', '軽減'],
     'リスク対応の4つの戦略は、回避・転嫁・軽減・受容です。「無視」は戦略ではありません。受容は意図的な判断であり、無視とは異なります。',
     3, NOW());

  -- Continue with remaining lessons...
  -- (Lessons 6-9 will follow the same pattern)

  -- Lesson 6: コミュニケーション計画と報告
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'communication-planning',
    'コミュニケーション計画と報告',
    '# コミュニケーション計画と報告

効果的なコミュニケーションは、**情報の種類・頻度・媒体・責任者を明確化**することから始まります。

## コミュニケーションマネジメント計画

### 計画で定義すべき内容

| 項目 | 内容 |
|------|------|
| **誰に** | ステークホルダー（受信者） |
| **何を** | 情報の種類（進捗、課題、リスク等） |
| **いつ** | 頻度とタイミング |
| **どのように** | 媒体（会議、メール、報告書等） |
| **誰が** | 送信責任者 |

## 情報の粒度調整

**受け手に応じて情報の深さを変える**

### 経営層向け
- 📊 エグゼクティブサマリ
- 🎯 主要マイルストーンの達成状況
- 🚨 重大な課題・リスク
- 💰 予算・スケジュールの差異

### プロジェクトスポンサー向け
- 📈 詳細な進捗状況
- ⚠️ 課題と対応策
- 🔄 変更要求の状況
- 📊 パフォーマンス指標（EVM等）

### チームメンバー向け
- ✅ タスクの状況
- 🔧 技術的な詳細
- 👥 役割分担
- 📅 次のアクション

## ステータスレポート

### 効果的なレポートの構成

#### 1. サマリ
- プロジェクト全体の状況を一目で把握

#### 2. 進捗状況
- ✅ 完了した作業
- 🔄 進行中の作業
- 📅 予定の作業

#### 3. 主要成果物
- 期間内に完成した成果物

#### 4. 課題（Issues）
- 現在直面している問題
- 対応状況と担当者

#### 5. リスク
- 新たに特定されたリスク
- 既存リスクの状況変化

#### 6. 次のアクション
- 次期間の主要活動

#### 7. 指標（メトリクス）
- スケジュール差異（SV）
- コスト差異（CV）
- CPI、SPI

## コミュニケーション技術

### プッシュ型コミュニケーション
送信者が能動的に情報を配信

**例：**
- 📧 メール送信
- 📄 報告書の配布
- 📢 プレゼンテーション

**特徴：**
- ✅ 確実に情報を伝達できる
- ⚠️ 受信者が読むとは限らない

### プル型コミュニケーション
受信者が必要に応じて情報を取得

**例：**
- 📚 プロジェクトポータル
- 🗄️ 文書管理システム
- 💾 共有ドライブ

**特徴：**
- ✅ 大量の情報を保管できる
- ⚠️ 受信者が見に行く必要がある

### インタラクティブ型コミュニケーション
双方向のリアルタイム対話

**例：**
- 👥 会議
- 📞 電話
- 💬 ビデオ会議

**特徴：**
- ✅ 即座にフィードバック可能
- ✅ 誤解をその場で解消
- ⚠️ 時間とリソースが必要

## 会議の効果的運営

### 会議前
- 📋 明確な議題を設定
- 📧 事前に資料を共有
- ⏰ 開始・終了時刻を明示
- 👥 必要な参加者のみ招集

### 会議中
- 🎯 議題に集中
- ⏱️ 時間を守る
- 📝 議事録を取る
- ✅ アクションアイテムと担当者を明確化

### 会議後
- 📄 議事録を速やかに共有
- ✅ アクションアイテムをフォロー
- 🔄 決定事項を関係者に展開

💡 **適切なコミュニケーション計画により、情報の過不足を防ぎ、プロジェクトの透明性を高めます。**',
    6,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-answer', '効果的なステータスレポートに含めるべき内容を全て選択してください。',
     ARRAY['進捗状況', '課題と対応策', '雑談内容', '次のアクション'],
     ARRAY['進捗状況', '課題と対応策', '次のアクション'],
     'ステータスレポートには、進捗、課題、リスク、次のアクション、指標などを含めます。雑談内容は業務報告には不要です。',
     1, NOW()),
    (v_lesson_id, 'multiple-choice', 'ステークホルダーごとに情報の粒度を変える理由はどれか？',
     ARRAY['受け取る側の理解度と関心度が異なるため', '情報を制限するため', '作業を減らすため', '全員に同じ情報を送る方が混乱するため'],
     ARRAY['受け取る側の理解度と関心度が異なるため'],
     '経営層には概要、現場には詳細というように、受け手の関心と理解度に応じて情報の深さを調整することで、効果的なコミュニケーションが実現します。',
     2, NOW()),
    (v_lesson_id, 'multiple-answer', 'インタラクティブ型コミュニケーションの例を全て選択してください。',
     ARRAY['会議', 'ビデオ会議', '共有ドライブ', 'メール送信'],
     ARRAY['会議', 'ビデオ会議'],
     'インタラクティブ型は双方向のリアルタイム対話です。共有ドライブはプル型、メールはプッシュ型のコミュニケーションです。',
     3, NOW());

  -- Lesson 7: 調達マネジメント
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'procurement-management',
    '調達マネジメント',
    '# 調達マネジメント

調達マネジメントでは、**外部のリソースやサービスを契約を通じて確保**します。

## 調達マネジメントプロセス

### 1. 調達マネジメント計画
何を調達するか、契約形態を決定

### 2. 調達の実行
ベンダー選定と契約締結

### 3. 調達のコントロール
契約履行の監視と管理

## 主な契約形態

### 1. 固定価格契約（FFP: Firm Fixed Price）

**特徴：**
- 💰 総額固定
- 📋 スコープ明確
- 🎯 成果物ベース

**リスク分担：**
- ベンダー：コスト超過リスクを負う
- 発注側：スコープ変更のリスク

**適用場面：**
- ✅ 要求事項が明確
- ✅ スコープが安定
- ✅ リスクを転嫁したい

### 2. コスト償還契約（CPFF: Cost Plus Fixed Fee）

**特徴：**
- 💵 実費 + 固定報酬
- 📊 コスト透明性が高い
- 🔄 柔軟性あり

**リスク分担：**
- ベンダー：努力義務
- 発注側：コスト超過リスクを負う

**適用場面：**
- ✅ 要求事項が不明確
- ✅ スコープが変動しやすい
- ✅ 専門性が高い

### 3. 工数単価契約（T&M: Time and Materials）

**特徴：**
- ⏱️ 時間単位で支払い
- 🔧 柔軟な対応

**リスク分担：**
- 発注側：工数増加リスクを負う

**適用場面：**
- ✅ 短期間の作業
- ✅ スコープが不明確
- ✅ 補助的な支援

## 契約形態の比較

| 項目 | 固定価格 | コスト償還 | 工数単価 |
|------|---------|-----------|---------|
| **発注側リスク** | 低 | 高 | 中～高 |
| **ベンダーリスク** | 高 | 低 | 低～中 |
| **柔軟性** | 低 | 高 | 高 |
| **管理工数** | 低 | 高 | 中 |

## 調達プロセスの実践

### 調達文書の作成

#### RFP（Request for Proposal: 提案依頼書）
- プロジェクト概要
- 要求事項
- 評価基準
- 提案期限

**目的：** 発注条件を明確化し、ベンダー間で公正な比較を可能にする

### ベンダー選定

#### 評価観点
| 観点 | 評価内容 |
|------|---------|
| **価格** | 見積もり金額の妥当性 |
| **技術力** | 提案内容の実現可能性 |
| **実績** | 類似案件の経験 |
| **体制** | チーム構成・スキル |
| **納期** | スケジュール遵守能力 |
| **品質** | 品質保証体制 |

#### 選定方法
- 📊 加重評価法
- 💰 最低価格選定
- 🎯 技術提案優先

### 契約管理

#### 契約履行の監視
- ✅ 成果物の検収
- 📅 マイルストーンの確認
- 💰 支払い条件の管理
- 📋 変更管理

#### 契約クローズ
- ✅ 最終成果物の承認
- 💵 最終支払いの処理
- 📄 文書のアーカイブ
- 📝 ベンダー評価

## Make or Buy 分析

**内製するか、外部調達するか**の意思決定

### 内製のメリット
- ✅ ノウハウの蓄積
- ✅ 機密保持
- ✅ 柔軟なコントロール

### 外部調達のメリット
- ✅ 専門性の活用
- ✅ リスクの転嫁
- ✅ コスト変動の回避

💡 **契約形態の選択は、リスク分担とプロジェクト特性を考慮して決定します。**',
    7,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', '固定価格契約の特徴はどれか？',
     ARRAY['ベンダーがコスト超過リスクを負う', '発注側が全てのリスクを負う', '作業時間に応じて支払う', 'コストの実績に応じて精算する'],
     ARRAY['ベンダーがコスト超過リスクを負う'],
     '固定価格契約では、総額が固定されるため、作業が予定より長引いてもベンダーがコスト超過リスクを負います。発注側はスコープ変更のリスクを負います。',
     1, NOW()),
    (v_lesson_id, 'multiple-choice', '調達文書の主な目的はどれか？',
     ARRAY['発注条件を明確化し、ベンダー間で公正な比較を可能にする', 'チームの配置を定義する', 'コストを減らす', '会議記録を保存する'],
     ARRAY['発注条件を明確化し、ベンダー間で公正な比較を可能にする'],
     '調達文書（RFP等）は、要求事項や評価基準を明確にし、複数のベンダーを公正に比較・評価するために作成します。',
     2, NOW()),
    (v_lesson_id, 'multiple-answer', 'ベンダー評価において重視すべき観点を全て選択してください。',
     ARRAY['価格', '技術力・実績', '営業担当者の印象', '体制・品質保証'],
     ARRAY['価格', '技術力・実績', '体制・品質保証'],
     'ベンダー評価では、価格、技術力、実績、体制、納期、品質保証などを総合的に評価します。営業担当者の印象は主観的であり、評価基準としては不適切です。',
     3, NOW());

  -- Lesson 8: 変更管理と構成管理
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'change-configuration-management',
    '変更管理と構成管理',
    '# 変更管理と構成管理

変更管理と構成管理は**異なる概念**ですが、連携して運用されます。

## 変更管理

**変更要求を適切に評価・承認・記録する仕組み**

### 変更管理プロセス

#### 1. 変更要求の提出
誰でも変更を提案できる仕組み

#### 2. 影響分析
変更がプロジェクトに与える影響を評価

**分析項目：**
| 項目 | 確認内容 |
|------|---------|
| **スコープ** | 作業範囲への影響 |
| **スケジュール** | 納期への影響 |
| **コスト** | 予算への影響 |
| **品質** | 品質基準への影響 |
| **リスク** | 新たなリスクの発生 |
| **資源** | 必要な追加リソース |

#### 3. CCB（変更管理委員会）での審議
- 📋 影響評価結果の確認
- 💬 ステークホルダーの意見聴取
- ✅ 承認/却下/保留の判断

#### 4. 変更の実行（承認された場合）
- 📄 計画書の更新
- 👥 チームへの通知
- 🔄 ベースラインの再設定（必要に応じて）

#### 5. 変更の記録
- 📝 変更履歴の保管
- 📊 変更の追跡

## 構成管理

**成果物のバージョンや状態を追跡・管理する活動**

### 構成管理の4つの活動

#### 1. 構成識別（Configuration Identification）
管理対象の成果物とバージョン体系を定義

**例：**
- 📄 要件定義書 v1.0, v1.1, v2.0
- 💻 ソースコード Rev.100, Rev.101
- 🎨 設計書 Draft, Review, Final

#### 2. 構成状態記録（Configuration Status Accounting）
各成果物の現在の状態を記録・追跡

**記録内容：**
- 現在のバージョン
- 承認状況
- 変更履歴

#### 3. 構成検証・監査（Configuration Verification and Audit）
成果物が基準に適合しているか確認

#### 4. 構成管理計画
構成管理の方法・ツール・責任者を定義

## 変更管理と構成管理の関係

### 変更管理
**「何を変えるか」を管理**
- 変更要求の評価
- 影響分析
- 承認プロセス

### 構成管理
**「変えたものを追跡」する**
- バージョン管理
- 状態記録
- 履歴保管

### 連携例

1. 変更要求が承認される（変更管理）
2. 成果物が更新される
3. 新しいバージョンが記録される（構成管理）
4. 変更履歴が保管される（両方）

## 構成管理ツール

### バージョン管理システム
- 💻 Git, SVN
- 📄 文書管理システム
- 🗂️ SharePoint

### 管理すべき成果物
- ✅ 要件定義書
- ✅ 設計書
- ✅ ソースコード
- ✅ テスト計画書
- ✅ ユーザーマニュアル
- ✅ プロジェクト計画書

## ベースライン管理

**ベースライン = 公式に承認された計画のスナップショット**

### 主要なベースライン
- 📋 スコープベースライン（WBS、WBS辞書、スコープ記述書）
- 📅 スケジュールベースライン
- 💰 コストベースライン

### ベースラインの役割
- 📊 パフォーマンス測定の基準
- 🔄 変更の影響評価の基準
- 📈 進捗報告の基準

💡 **変更管理で「なぜ変えるか」を判断し、構成管理で「何がどう変わったか」を記録します。**',
    8,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', '変更管理と構成管理の関係として正しいものはどれか？',
     ARRAY['構成管理が変更管理を包含する', '変更管理が構成管理を包含する', '両者は目的が異なるが連携して運用される', 'まったく無関係である'],
     ARRAY['両者は目的が異なるが連携して運用される'],
     '変更管理は「何を変えるか」の意思決定、構成管理は「変更の追跡・記録」を担います。目的は異なりますが、連携してプロジェクトの整合性を保ちます。',
     1, NOW()),
    (v_lesson_id, 'multiple-answer', '変更要求の影響分析で考慮すべき項目を全て選択してください。',
     ARRAY['スコープへの影響', 'コストへの影響', 'スケジュールへの影響', 'メンバーの性格'],
     ARRAY['スコープへの影響', 'コストへの影響', 'スケジュールへの影響'],
     '変更の影響分析では、スコープ・コスト・スケジュール・品質・リスクへの影響を評価します。メンバーの性格は影響分析の対象ではありません。',
     2, NOW()),
    (v_lesson_id, 'multiple-choice', '構成識別で定義されるものはどれか？',
     ARRAY['成果物やドキュメントのバージョン体系', 'PMの役職名', 'コスト構造', 'チーム構成'],
     ARRAY['成果物やドキュメントのバージョン体系'],
     '構成識別では、管理対象の成果物を特定し、バージョン番号の付け方（v1.0, v1.1等）やネーミングルールを定義します。',
     3, NOW());

  -- Lesson 9: 教訓管理と組織知識の活用
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'lessons-learned-knowledge',
    '教訓管理と組織知識の活用',
    $CONTENT$# 教訓管理と組織知識の活用

中級PMは、**プロジェクトを単発で終わらせず、組織資産として活用する**責任を持ちます。

## Lessons Learned（教訓）とは

**プロジェクトから得られた知見を整理し、次に活かす**

### 教訓の種類

#### ✅ 成功要因（うまくいったこと）
- 何が成功につながったか
- なぜうまくいったのか
- 次も続けるべき行動

**例：**
- 毎週の進捗会議が問題の早期発見につながった
- プロトタイプ開発で要件の認識齟齬を防げた
- リスク分析を丁寧に行ったことで大きなトラブルを回避

#### ❌ 失敗要因（うまくいかなかったこと）
- 何が問題だったか
- なぜ問題が起きたのか
- 次はどう改善すべきか

**例：**
- 初期のスコープ定義が曖昧で手戻りが発生
- ステークホルダーとの合意形成が不十分
- 見積もりが楽観的すぎてスケジュール遅延

## 教訓を収集するタイミング

### ❌ プロジェクト終結時のみ
- 記憶が曖昧になる
- メンバーが解散している
- 形式的になりがち

### ✅ 主要マイルストーンごと
- フェーズ完了時
- 重要な成果物完成時
- 問題発生・解決時

💡 **教訓は「生きた情報資産」。プロジェクト中にも更新すべき**

## 組織のプロセス資産（OPA）

**Organization Process Assets = 組織が蓄積した知識・ノウハウ**

### OPAに含まれるもの

#### 1. プロセス・手順
- 📋 標準的なプロジェクト計画テンプレート
- 📊 WBS標準フォーマット
- 🔄 変更管理プロセス
- ✅ 品質チェックリスト

#### 2. 過去のプロジェクト情報
- 📄 過去のプロジェクト計画書
- 📝 教訓データベース
- 📊 見積もり実績データ
- 🎯 リスク事例集

#### 3. 知識ベース
- 💡 ベストプラクティス
- 📚 技術資料
- 🗃️ FAQ・Q&A集

## 教訓の共有と活用

### ナレッジマネジメントシステム

#### 機能
- 📚 教訓の登録・検索
- 🏷️ カテゴリ分類（技術、管理、組織等）
- ⭐ 評価・コメント
- 🔔 新着通知

#### 活用方法
| シーン | 活用内容 |
|--------|---------|
| **プロジェクト立上げ** | 類似案件の教訓を参照 |
| **リスク特定** | 過去のリスク事例を活用 |
| **見積もり** | 過去の実績データを参考 |
| **問題発生時** | 類似問題の解決策を検索 |

### 教訓共有会の実施

#### 目的
- 🎓 経験の共有
- 💬 対話を通じた気づき
- 🤝 組織横断の学習

#### 実施方法
- 定期的な勉強会
- プロジェクト報告会
- ワークショップ

## 継続的改善の文化

### PDCAサイクル

```
Plan（計画）
  ↓
Do（実行）
  ↓
Check（評価・教訓収集）
  ↓
Act（改善・次回への反映）
  ↓
（繰り返し）
```

### 組織の成熟度向上

教訓の活用により：
- 📈 プロジェクト成功率の向上
- ⏱️ 立上げ期間の短縮
- 💰 見積もり精度の向上
- 🚨 リスク対応力の強化

## 教訓管理のベストプラクティス

### ✅ Do
- 簡潔で具体的に記述
- 原因と対策をセットで記録
- 定期的に見直す
- 新人教育に活用

### ❌ Don't
- 責任追及の場にしない
- 形式的な記録で終わる
- データベースに放置
- アクセスしにくい場所に保管

💡 **教訓の蓄積と活用は、組織全体のプロジェクトマネジメント能力を高めます。**$CONTENT$,
    9,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', 'Lessons Learnedはいつ収集するのが最も効果的か？',
     ARRAY['プロジェクト終結時のみ', '主要マイルストーンごと', '実行開始前のみ', '監査時のみ'],
     ARRAY['主要マイルストーンごと'],
     '教訓は記憶が鮮明なうちに、主要マイルストーンごとに収集するのが効果的です。終結時のみでは記憶が曖昧になり、形式的になりがちです。',
     1, NOW()),
    (v_lesson_id, 'multiple-answer', '組織のプロセス資産（OPA）に含まれるものを全て選択してください。',
     ARRAY['過去のプロジェクト計画書', '教訓データベース', '外部ステークホルダー情報', '標準テンプレート'],
     ARRAY['過去のプロジェクト計画書', '教訓データベース', '標準テンプレート'],
     'OPAは組織が蓄積した知識・ノウハウであり、過去のプロジェクト情報、教訓、標準プロセス・テンプレートなどが含まれます。外部ステークホルダー情報はEEF（環境要因）です。',
     2, NOW()),
    (v_lesson_id, 'multiple-choice', '教訓の共有を促進する仕組みとして有効なものはどれか？',
     ARRAY['社内ナレッジデータベースの整備', '口頭伝達のみに頼る', '非公式なチャットでの記録のみ', 'プロジェクト終了後に削除する'],
     ARRAY['社内ナレッジデータベースの整備'],
     '教訓を組織資産として活用するには、検索・参照しやすいナレッジデータベースの整備が有効です。口頭のみでは属人化し、非公式記録は散逸します。',
     3, NOW());

END $$;
