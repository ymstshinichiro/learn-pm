-- 現場型プロジェクトマネジメントコース: レッスン12
-- 安全・品質・工期を両立するための意思決定とリスクバランス

DO $$
DECLARE
  v_course_id INT;
  v_lesson_id INT;
BEGIN
  -- コースIDを取得
  SELECT id INTO v_course_id FROM courses WHERE slug = 'field-pm';

  -- レッスン12を挿入
  INSERT INTO lessons (course_id, slug, title, content, "order", created_at)
  VALUES (
    v_course_id,
    'decision-making-risk-balance',
    '安全・品質・工期を両立するための意思決定とリスクバランス',
    $CONTENT$# 安全・品質・工期を両立するための意思決定とリスクバランス

## 📋 このレッスンで学ぶこと

現場マネージャーの最大の役割は「意思決定」です。本レッスンでは、工期・品質・安全・コストのトレードオフを理解し、状況に応じた最適な判断を下す実践的手法を学びます。

---

## 🎯 意思決定の基本原則

### 意思決定とは

**定義**: 複数の選択肢の中から、最適なものを選ぶプロセス

**特徴**:
- 完全な情報はない（不確実性）
- トレードオフが存在する
- タイミングが重要（遅れると機会損失）

### 良い意思決定の条件

| 条件 | 内容 |
|-----|------|
| **目的の明確化** | 何を達成したいのか |
| **情報の収集** | 事実に基づく判断 |
| **選択肢の列挙** | 複数の選択肢を検討 |
| **リスクの評価** | 各選択肢のリスクと効果 |
| **決断と実行** | 迅速な判断、責任を持つ |

---

## ⚖️ トレードオフの理解

### 4大管理のトレードオフ

```
     安全（絶対条件）
         ↓
   [品質] ⇄ [工期] ⇄ [コスト]

一つを改善すると、他が悪化する
```

### トレードオフの具体例

#### 例1: 工期短縮の要求

```
【選択肢A: クラッシング（人員増強）】
メリット: 工期短縮
デメリット: コスト増、安全リスク増

【選択肢B: 工法変更】
メリット: 工期短縮、品質安定
デメリット: 技術リスク、コスト増

【選択肢C: 品質基準の見直し】
メリット: 工期短縮、コスト削減
デメリット: 品質低下、顧客不満

【選択肢D: 顧客と納期再交渉】
メリット: 品質・安全維持
デメリット: 顧客との信頼関係リスク
```

#### 意思決定のプロセス

```
1. 現状分析
   遅延5日、原因は天候不良

2. 目標確認
   納期厳守が契約条件（ペナルティあり）

3. 選択肢とトレードオフ
   A: クラッシング（コスト+50万、安全リスク）
   D: 再交渉（信頼関係リスク、ペナルティ回避）

4. 判断基準
   安全は犠牲にできない
   コスト+50万は利益内で吸収可能

5. 決定
   選択肢A（クラッシング）を採用
   ただし安全対策を強化

6. 実行と モニタリング
```

---

## 🧮 リスクベースの意思決定

### リスクマトリクス

```
影響度
 大 │  中   高   高
    │
 中 │  低   中   高
    │
 小 │  低   低   中
    └─────────────
       低   中   高
         発生確率
```

### リスク対応の4つの戦略

| 戦略 | 内容 | 例 |
|-----|------|---|
| **回避** | リスクを排除する | 危険な工法を避ける |
| **軽減** | 発生確率・影響度を下げる | 安全対策を強化 |
| **転嫁** | リスクを他者に移す | 保険加入、外注 |
| **受容** | リスクを受け入れる | 小さなリスクは許容 |

### リスクベース意思決定の例

```
【状況】
台風接近、明日の屋外作業実施可否

【選択肢A: 作業実施】
- メリット: 工程通り、納期維持
- リスク: 墜落・飛来事故（発生確率: 中、影響度: 大）
- リスクレベル: 高

【選択肢B: 作業中止】
- メリット: 安全確保
- デメリット: 工期1日遅延、コスト増（待機費用）
- リスク: 低

【判断】
リスクレベル「高」は受容できない
→ 作業中止を決定
→ 工期遅延は他の工程で挽回策を検討
```

---

## 🚦 意思決定のフレームワーク

### 決定マトリクス

複数の選択肢を定量的に評価する手法

```
【例: 協力会社の選定】

評価項目      重み  A社  B社  C社
─────────────────────────
技術力        30%   8    9    7
価格          25%   6    8    9
納期遵守      25%   9    7    8
安全管理      20%   8    9    6
─────────────────────────
総合評価           7.7  8.1  7.6

※ 各項目を10点満点で評価、重み付けして合計

結論: B社を選定
```

### SWOT分析

```
【内部要因】
強み（Strengths）
- 経験豊富な作業員
- 過去実績多数

弱み（Weaknesses）
- 新工法の経験なし
- リソース不足

【外部要因】
機会（Opportunities）
- 顧客の追加案件
- 新技術の導入可能

脅威（Threats）
- 競合の低価格攻勢
- 資材価格高騰

→ 強みを活かし、機会を捉える戦略
```

---

## ⏱️ タイミングと速度

### 意思決定のタイミング

```
【早すぎる判断】
情報不足、誤った判断

【適切なタイミング】
十分な情報、迅速な判断

【遅すぎる判断】
機会損失、被害拡大
```

### 80%ルール

**原則**: 情報が80%揃ったら決断する

- 100%の情報を待つと遅すぎる
- 50%では不確実性が高すぎる
- 80%で判断、残り20%は実行しながら調整

### 可逆性による判断速度

```
【可逆的な決定（やり直せる）】
→ 早く決断、試して修正

例: 資材置き場の配置変更

【不可逆的な決定（やり直せない）】
→ 慎重に情報収集、熟考

例: コンクリート打設、基礎位置決定
```

---

## 🎯 ケーススタディ

### ケース1: 工期遅延への対応

```
【状況】
- 工期: あと2週間で完成予定
- 現状: 5日遅延
- 原因: 天候不良
- 契約: 納期遅延でペナルティ

【選択肢】
A: クラッシング（人員2倍、コスト+100万円）
B: 工法変更（プレハブ化、コスト+50万円、技術リスク）
C: 品質基準の緩和（顧客承認必要）
D: 納期再交渉（ペナルティ支払い50万円）

【判断のポイント】
1. 安全は犠牲にしない
2. 品質基準の緩和は顧客満足度低下
3. コストとペナルティを比較
4. 技術リスクの評価

【判断】
選択肢A（クラッシング）
- 理由: コスト+100万はペナルティ+信頼失墜より安い
- 条件: 残業管理、安全対策強化
```

### ケース2: 品質不良の発見

```
【状況】
- 引渡し1週間前に品質不良発見
- 是正に3日必要
- このままだと納期遅延

【選択肢】
A: 是正せずに引渡し（品質不良を隠す）
B: 是正して納期遅延を顧客に報告
C: 是正と並行で他工程を加速し納期維持

【判断のポイント】
1. 品質不良の隠蔽は論外（信頼・訴訟リスク）
2. 顧客への誠実な報告
3. 納期維持の可能性を探る

【判断】
選択肢C、不可能ならB
- 理由: 品質は妥協できない
- 行動: 顧客に即座に報告、是正と加速を並行
```

---

## 🧠 意思決定の罠

### よくある判断ミス

| 罠 | 内容 | 対策 |
|----|------|------|
| **確証バイアス** | 自分の仮説に合う情報だけ集める | 反対意見も積極的に聞く |
| **サンクコスト** | 過去の投資を惜しみ、誤った継続 | 過去は無視、将来の損益で判断 |
| **集団思考** | 全員一致で批判的検討なし | 悪魔の代弁者を置く |
| **過信** | 自分の判断を過信、リスク軽視 | データで検証、第三者意見 |

---

## 📊 データドリブン意思決定

### 定量的判断の重要性

```
【定性的判断】
「工期が遅れている気がする」

【定量的判断】
「進捗率80%、計画より5%遅延
 クリティカルパス上で2日の遅れ」

→ 定量データで正確な判断
```

### KPIに基づく判断

```
週次チェック:
- 工程達成率: 95%以上 → OK
- 原価率: 90%以下 → OK
- 無災害日数: 継続 → OK
- 品質検査合格率: 98%以上 → OK

→ すべてグリーンなら問題なし
→ 一つでもレッドなら即座に対策
```

---

## ⚠️ よくある失敗パターン

### 失敗パターン1: 優先順位が曖昧

**症状**: 工期・品質・コストの板挟みで判断できない

**原因**: 優先順位が不明確

**対策**: プロジェクト開始時に優先順位を明確化

### 失敗パターン2: 情報不足で判断

**症状**: 誤った判断、後で覆す

**原因**: 情報収集を怠る、現場確認なし

**対策**: 80%の情報を集めてから判断

### 失敗パターン3: 決断の先延ばし

**症状**: 判断を避け、問題が悪化

**原因**: 責任を恐れる、完璧主義

**対策**: 80%ルール、不可逆性を考慮

---

## 🎓 まとめ

意思決定は、現場マネージャーの最も重要な仕事です。

### 成功のための5つのポイント

1. **トレードオフの理解**: 一つを改善すると他が悪化することを認識
2. **安全は絶対条件**: どんな状況でも安全は譲らない
3. **データに基づく判断**: 定量的な情報で客観的に
4. **リスク評価**: 発生確率と影響度を評価、対策を検討
5. **迅速な決断**: 80%の情報で判断、実行しながら調整

「迷ったら原点に戻れ」— 安全第一、顧客満足、チームの尊重。この原則に従えば、正しい判断ができます。

---

## 🏁 コース完了おめでとうございます！

このコースで学んだ知識を現場で実践し、優れた現場マネージャーとして活躍されることを期待しています。

**現場の成功を祈っています！**
$CONTENT$,
    12,
    NOW()
  ) RETURNING id INTO v_lesson_id;

  -- レッスン12の質問を挿入
  INSERT INTO questions (lesson_id, type, question, options, correct_answer, explanation, "order", created_at)
  VALUES
    (v_lesson_id, 'multiple-choice', '工期が5日遅延し、顧客から「納期厳守」の要求。クラッシング（人員増強）でコスト+100万円、納期遅延ペナルティ50万円。最も適切な判断はどれですか？',
     ARRAY['ペナルティ50万円の方が安いので、納期遅延を受け入れる',
           'クラッシングでコスト+100万円払い、納期を守る（ただし安全対策を強化）',
           '品質基準を緩和し、検査を簡素化して工期を短縮する',
           '作業員に無理をさせ、コストをかけずに納期を守る'],
     ARRAY['クラッシングでコスト+100万円払い、納期を守る（ただし安全対策を強化）'],
     'Aはペナルティだけの比較ですが、納期遅延は「信頼失墜」「次回受注への影響」という無形のコストがあり、50万円以上の損失です。Cの品質基準緩和は顧客満足度低下、瑕疵リスクがあります。Dの無理強いは安全リスクが高く、労災が発生すれば全てを失います。Bが正解で、コスト+100万円は「納期遵守による信頼維持」「次回受注の確保」を考えれば投資価値があります。ただし安全は絶対条件なので、残業管理・安全対策強化が必須です。意思決定の鉄則は「短期コストだけでなく、長期的な価値・リスクを総合判断」です。',
     1, NOW()),

    (v_lesson_id, 'multiple-choice', '引渡し1週間前に品質不良を発見。是正に3日必要で、そのままだと納期遅延。最も適切な対応はどれですか？',
     ARRAY['品質不良は軽微なので、そのまま引き渡し、後で問題が出たら対応する',
           '顧客に即座に報告し、是正と並行で他工程を加速、納期維持を試みる。不可能なら納期遅延を正直に伝える',
           '品質不良を隠したまま引き渡し、後で「経年劣化」として処理する',
           '協力会社に責任を押し付け、顧客には「協力会社のミス」と説明する'],
     ARRAY['顧客に即座に報告し、是正と並行で他工程を加速、納期維持を試みる。不可能なら納期遅延を正直に伝える'],
     'A、Cは品質不良の隠蔽であり、後で発覚すれば信頼失墜・訴訟リスク・瑕疵対応コストが発生します。Dの責任転嫁は、元請の責任放棄であり、顧客の信頼を失います。Bが正解で、品質は絶対に妥協できません。まず顧客に即座に正直に報告し、①是正を最優先、②並行で他工程の加速を試み納期維持を目指す、③不可能なら納期遅延を受け入れる、という順序です。誠実な対応により、顧客の信頼は維持できます。意思決定の鉄則は「品質・安全は譲れない、工期・コストは調整可能」です。',
     2, NOW()),

    (v_lesson_id, 'multiple-choice', '「80%ルール」の意思決定原則について、最も適切な説明はどれですか？',
     ARRAY['情報が100%揃うまで待ち、完璧な判断をする',
           '情報が80%揃ったら決断し、残り20%は実行しながら調整する',
           '情報が50%でも直感で判断し、スピードを重視する',
           '80%の確率で成功する案を選ぶ'],
     ARRAY['情報が80%揃ったら決断し、残り20%は実行しながら調整する'],
     'Aの100%待ちは、判断が遅すぎて機会損失・被害拡大を招きます。現場は100%の情報は揃わず、待っていても状況は変化します。Cの50%直感判断は不確実性が高すぎて、誤った判断のリスクが大きいです。Dは「80%ルール」の誤解で、成功確率ではなく情報量の話です。Bが正解で、80%の情報が揃ったら決断し、残り20%の不確実性は実行しながら調整します。これにより、迅速な判断と柔軟な対応のバランスが取れます。意思決定の鉄則は「完璧を待たず、十分な情報で決断」です。',
     3, NOW()),

    (v_lesson_id, 'multiple-answer', 'リスクベースの意思決定で考慮すべき要素はどれですか？（複数選択）',
     ARRAY['リスクの発生確率（低・中・高）を評価する',
           'リスクが発生した場合の影響度（小・中・大）を評価する',
           'リスクレベル（発生確率×影響度）に応じて、回避・軽減・転嫁・受容の戦略を決める',
           'すべてのリスクを完全に排除することを目指す'],
     ARRAY['リスクの発生確率（低・中・高）を評価する', 'リスクが発生した場合の影響度（小・中・大）を評価する', 'リスクレベル（発生確率×影響度）に応じて、回避・軽減・転嫁・受容の戦略を決める'],
     'A、B、Cが正解です。リスクベース意思決定では、①発生確率を評価、②影響度を評価、③リスクレベル（発生確率×影響度）を算出、④リスクレベルに応じて戦略（回避・軽減・転嫁・受容）を決定、という手順です。Dは誤りで、すべてのリスクを排除するのは不可能かつ非効率です。小さなリスクは「受容」し、大きなリスクに集中することが合理的です。リスク管理の鉄則は「リスクをゼロにするのではなく、許容可能なレベルに管理する」ことです。',
     4, NOW()),

    (v_lesson_id, 'multiple-choice', '工期・品質・コスト・安全のトレードオフで判断に迷った時、最も基本となる原則はどれですか？',
     ARRAY['工期を最優先し、納期を守ることで顧客との信頼関係を維持する',
           '安全は絶対条件として譲らず、その上で工期・品質・コストの優先順位を判断する',
           'コストを最優先し、利益を確保することで会社の継続性を守る',
           '状況に応じて柔軟に優先順位を変え、その時々で最適な判断をする'],
     ARRAY['安全は絶対条件として譲らず、その上で工期・品質・コストの優先順位を判断する'],
     'A、C、Dはすべて状況に応じて変わる「変動要素」です。工期優先、コスト優先、柔軟な変更、いずれもケースバイケースです。Bが正解で、唯一の「絶対条件」は安全です。労働災害は①人命に関わる、②プロジェクト中断、③企業の信用失墜、④訴訟リスク、と取り返しのつかない結果を招きます。現場の鉄則は「安全第一、品質第二、工期第三」であり、どんな状況でも安全だけは譲れません。トレードオフの原則は「安全は絶対、他は状況に応じて」です。',
     5, NOW());

END $$;
