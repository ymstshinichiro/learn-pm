-- 中級・上級コースの問題をひっかけ形式に変更

-- ===== 中級コース =====

-- レッスン1: 統合マネジメントの実践
UPDATE questions SET
  question = '統合変更管理で変更要求を評価する際、最も重要な判断基準はどれですか？',
  options = ARRAY[
    '変更要求者の役職や影響力を考慮し、重要な人物からの要求を優先的に承認する',
    '変更の実装コストが低ければ、影響評価を省略して迅速に承認する',
    '変更がスコープ・スケジュール・コスト・品質・リスクに与える影響を総合的に評価し、プロジェクト目標達成への寄与度で判断する',
    'すべての変更要求を一律に却下し、当初計画を厳格に守ることで安定性を確保する'
  ],
  correct_answer = ARRAY['変更がスコープ・スケジュール・コスト・品質・リスクに与える影響を総合的に評価し、プロジェクト目標達成への寄与度で判断する'],
  explanation = 'Aの役職優先は、変更の実質的価値を無視しており、プロジェクト目標達成とは無関係です。Bのコスト優先・影響評価省略は、後で大きな問題を引き起こすリスクがあります（スケジュール遅延、品質低下等）。Dの一律却下は硬直的で、必要な変更（バグ修正、重要な改善）も拒否してしまいます。Cが正解で、統合変更管理の本質は「変更の影響を多角的に評価」（スコープ、スケジュール、コスト、品質、リスク）し、「プロジェクト目標達成への寄与度」で承認・却下を判断することです。'
WHERE lesson_id = 15 AND "order" = 1;

UPDATE questions SET
  question = 'プロジェクトマネジメント計画書に含めるべき内容として最も不適切なのはどれですか？',
  options = ARRAY[
    'スコープマネジメント計画、スケジュールマネジメント計画、コストマネジメント計画などの個別計画',
    '品質マネジメント計画、リスクマネジメント計画、ステークホルダー関与計画',
    'プロジェクトメンバー個人の日報や週報の詳細な記録',
    '変更管理プロセス、コミュニケーション計画、調達マネジメント計画'
  ],
  correct_answer = ARRAY['プロジェクトメンバー個人の日報や週報の詳細な記録'],
  explanation = 'A、B、Dはすべてプロジェクトマネジメント計画書に含まれるべき個別のマネジメント計画です。Cが不適切で、日報・週報は「プロジェクト実行時の記録」であり、「計画書（事前に定める方針・手順）」ではありません。プロジェクトマネジメント計画書は「どのようにプロジェクトを実行・監視・コントロールするか」を定義するものであり、実行中の日次記録を含めるものではありません。'
WHERE lesson_id = 15 AND "order" = 2;

UPDATE questions SET
  question = 'ナレッジマネジメントで「教訓管理（Lessons Learned）」を効果的に活用するために最も重要なのはどれですか？',
  options = ARRAY[
    'プロジェクト終了後に教訓をまとめ、報告書として保管しておく',
    '成功したプロジェクトの教訓のみを記録し、失敗事例は記録しない（企業イメージ保護のため）',
    'プロジェクト全フェーズで教訓を収集し、即座に組織のナレッジベースに登録、他のプロジェクトでも検索・活用できる仕組みを作る',
    '教訓はプロジェクトマネージャーのみが記録し、チームメンバーからの報告は不要とする'
  ],
  correct_answer = ARRAY['プロジェクト全フェーズで教訓を収集し、即座に組織のナレッジベースに登録、他のプロジェクトでも検索・活用できる仕組みを作る'],
  explanation = 'Aの終了後まとめは、プロジェクト進行中に他のプロジェクトが同じ失敗を繰り返すリスクがあります。Bの成功のみ記録は、失敗から学ぶ機会を失い、組織の成長を妨げます（失敗事例こそ貴重な学び）。Dのマネージャーのみ記録は、現場の貴重な知見を取りこぼします。Cが正解で、効果的なナレッジマネジメントは①全フェーズで継続的に収集、②即座に登録（鮮度が重要）、③検索可能な形で蓄積、④他プロジェクトでの活用、という仕組みが必要です。'
WHERE lesson_id = 15 AND "order" = 3;

-- レッスン2: ステークホルダーマネジメント
UPDATE questions SET
  question = 'ステークホルダー分析で「権力・関心マトリクス」を使う目的として最も適切なのはどれですか？',
  options = ARRAY[
    'すべてのステークホルダーを平等に扱い、公平性を確保するため',
    'ステークホルダーを権力と関心の2軸で分類し、各象限に応じた関与戦略（密接管理、満足維持、監視、情報提供）を決定するため',
    '権力のあるステークホルダーのみを重視し、他は無視することで効率化するため',
    'ステークホルダーの数を減らし、コミュニケーションコストを削減するため'
  ],
  correct_answer = ARRAY['ステークホルダーを権力と関心の2軸で分類し、各象限に応じた関与戦略（密接管理、満足維持、監視、情報提供）を決定するため'],
  explanation = 'Aの平等扱いは一見公平ですが、限られたリソースで全員に同じ労力をかけるのは非効率であり、重要なステークホルダーへの対応が手薄になります。Cの権力者のみ重視は、関心の高いステークホルダーを軽視し、後で反対勢力になるリスクがあります。Dのステークホルダー削減は本質ではありません。Bが正解で、権力・関心マトリクスの目的は「効率的な関与戦略の決定」です。高権力・高関心→密接管理、高権力・低関心→満足維持、低権力・高関心→情報提供、低権力・低関心→監視、と象限ごとに異なる戦略を取ります。'
WHERE lesson_id = 16 AND "order" = 1;

UPDATE questions SET
  question = 'ステークホルダーの関与レベルを「抵抗→中立→支持→指導」に引き上げるために最も効果的な手法はどれですか？',
  options = ARRAY[
    'ステークホルダーの懸念や期待を無視し、プロジェクトチームの判断のみで進める',
    'ステークホルダーとの定期的なコミュニケーションで意見を聴取し、期待と実際のギャップを把握、必要に応じて調整する',
    '抵抗的なステークホルダーをプロジェクトから排除し、支持者のみで進める',
    '一方的に進捗報告を送付するのみで、フィードバックは求めない'
  ],
  correct_answer = ARRAY['ステークホルダーとの定期的なコミュニケーションで意見を聴取し、期待と実際のギャップを把握、必要に応じて調整する'],
  explanation = 'Aの無視は、ステークホルダーの抵抗を強め、プロジェクトの障害になります。Cの排除は、影響力のあるステークホルダーの場合、プロジェクト中止のリスクがあります。Dの一方的報告は、ステークホルダーの関与を高めることはできません。Bが正解で、関与レベルを引き上げる鍵は「双方向コミュニケーション」です。ステークホルダーの意見を聴取し、期待を理解し、ギャップがあれば調整することで、抵抗→中立→支持→指導へと関与レベルが向上します。ステークホルダーマネジメントの本質は「関係構築」です。'
WHERE lesson_id = 16 AND "order" = 2;

UPDATE questions SET
  question = 'ステークホルダー登録簿に記録すべき情報として適切なものはどれですか？（複数選択）',
  options = ARRAY[
    'ステークホルダーの氏名、役職、連絡先、影響力レベル',
    'ステークホルダーの期待、懸念事項、関与レベル（現在・目標）',
    'ステークホルダーの個人的な趣味や家族構成',
    'ステークホルダーごとのコミュニケーション方法（頻度、形式、内容）'
  ],
  correct_answer = ARRAY['ステークホルダーの氏名、役職、連絡先、影響力レベル', 'ステークホルダーの期待、懸念事項、関与レベル（現在・目標）', 'ステークホルダーごとのコミュニケーション方法（頻度、形式、内容）'],
  explanation = 'A、B、Dが正解です。ステークホルダー登録簿には、①基本情報（氏名、役職、連絡先）、②影響力・関心レベル、③期待・懸念事項、④現在・目標の関与レベル、⑤コミュニケーション方法、を記録します。Cの個人的趣味・家族構成は、プロジェクトマネジメントに直接関係なく、プライバシー侵害のリスクもあります（ただし、関係構築の雑談ネタとして知っておくことは有用ですが、公式文書には不要）。ステークホルダー登録簿の目的は「効果的な関与戦略の実行」です。'
WHERE lesson_id = 16 AND "order" = 3;

-- レッスン3: 品質マネジメントの実践
UPDATE questions SET
  question = '品質保証（QA）と品質管理（QC）の関係について最も適切な説明はどれですか？',
  options = ARRAY[
    'QAとQCは同じ意味で、どちらも成果物の検査・テストを指す',
    'QAはプロセス改善により欠陥を予防する活動、QCは成果物の検査により欠陥を検出する活動であり、両方が必要',
    'QAがあればQCは不要で、プロセスさえ良ければ検査は省略できる',
    'QCは開発チームの活動、QAは経営層の活動であり、役割が明確に分かれている'
  ],
  correct_answer = ARRAY['QAはプロセス改善により欠陥を予防する活動、QCは成果物の検査により欠陥を検出する活動であり、両方が必要'],
  explanation = 'Aは誤りで、QAとQCは異なる概念です。Cは誤りで、プロセスが良くても人間のミスは起こるため、QC（検査）は必要です。Dは誤りで、開発/経営の区別ではなく、予防/検出のアプローチの違いです。Bが正解で、QA（Quality Assurance: 品質保証）はプロセス志向で「欠陥を作らない仕組み」を作る予防活動、QC（Quality Control: 品質管理）は成果物志向で「欠陥を見つける」検出活動です。理想はQAで欠陥を減らし、QCで最終確認する組み合わせです。'
WHERE lesson_id = 17 AND "order" = 1;

UPDATE questions SET
  question = '品質コストにおいて、最も費用対効果が高い投資はどれですか？',
  options = ARRAY[
    '適合コストの「評価コスト」（検査・テスト）を増やし、不良品を確実に検出する',
    '適合コストの「予防コスト」（教育訓練、プロセス改善）を増やし、そもそも欠陥を作らないようにする',
    '不適合コストの「内部失敗コスト」（手戻り）を受け入れ、後で修正する',
    '不適合コストの「外部失敗コスト」（顧客クレーム対応）に予算を確保し、事後対応を充実させる'
  ],
  correct_answer = ARRAY['適合コストの「予防コスト」（教育訓練、プロセス改善）を増やし、そもそも欠陥を作らないようにする'],
  explanation = 'Aの評価コスト増は重要ですが、欠陥を作ってから検出するため、手戻りコストは発生します。C、Dの不適合コスト（失敗コスト）は、欠陥が発生した後のコストであり、最も高くつきます（特に外部失敗コストは内部の10倍以上）。Bが正解で、予防コスト（教育訓練、標準化、プロセス改善、設計レビュー）は、欠陥を「作らない」ため、評価コストや失敗コストを大幅に削減できます。品質コストの原則は「予防 < 評価 << 内部失敗 <<< 外部失敗」の順でコストが跳ね上がることであり、予防投資が最も費用対効果が高いです。'
WHERE lesson_id = 17 AND "order" = 2;

UPDATE questions SET
  question = '品質管理で使用される「フィッシュボーン図（特性要因図）」の主な目的はどれですか？',
  options = ARRAY[
    'プロジェクトのスケジュールを視覚化し、クリティカルパスを特定する',
    '品質問題の根本原因を体系的に分析し、「人・機械・材料・方法・測定・環境」などの観点から要因を洗い出す',
    'プロジェクトのコストを管理し、予算超過を防ぐ',
    'ステークホルダーの権力と関心を分析し、関与戦略を決定する'
  ],
  correct_answer = ARRAY['品質問題の根本原因を体系的に分析し、「人・機械・材料・方法・測定・環境」などの観点から要因を洗い出す'],
  explanation = 'Aはスケジュール管理（ガントチャート、PERT図等）の目的で、フィッシュボーン図とは無関係です。Cはコスト管理（EVM等）の目的です。Dはステークホルダーマネジメント（権力・関心マトリクス）の目的です。Bが正解で、フィッシュボーン図（特性要因図、石川ダイアグラム）は、品質問題の原因を「体系的に」分析するツールです。魚の骨のような図で、背骨に「問題」を書き、骨に「要因カテゴリ（4M: Man, Machine, Material, Method + Measurement, Environment）」を配置し、各カテゴリから具体的な原因を洗い出します。根本原因分析に有効です。'
WHERE lesson_id = 17 AND "order" = 3;

-- レッスン4: コストマネジメント
UPDATE questions SET
  question = 'EVM（Earned Value Management）で「CPI=0.85、SPI=1.10」という結果。この状況の解釈として正しいのはどれですか？',
  options = ARRAY[
    'コスト効率が良く（CPI>1）、スケジュールも順調（SPI>1）で、プロジェクトは健全',
    'コスト超過（CPI<1）が発生しているが、スケジュールは前倒し（SPI>1）で進んでいる',
    'コスト効率が悪く（CPI<1）、スケジュールも遅延（SPI<1）しており、二重苦の状態',
    'CPIとSPIの値から判断できる情報はなく、他の指標が必要'
  ],
  correct_answer = ARRAY['コスト超過（CPI<1）が発生しているが、スケジュールは前倒し（SPI>1）で進んでいる'],
  explanation = 'Aは誤りで、CPI=0.85は1.0未満であり、コスト超過（非効率）を意味します。Cは誤りで、SPI=1.10は1.0以上であり、スケジュール遅延ではなく前倒しです。Dは誤りで、CPI、SPIから明確に状況判断できます。Bが正解で、CPI（Cost Performance Index）=EV/ACで、0.85は「100のコストで85の出来高」を意味し、15%コスト超過です。SPI（Schedule Performance Index）=EV/PVで、1.10は「計画の110%進んでいる」=10%前倒しです。この状況は「スケジュールを前倒しするために人員増強等を行い、コストが超過している」可能性があります。'
WHERE lesson_id = 18 AND "order" = 1;

UPDATE questions SET
  question = 'コスト見積もりで「三点見積もり」を使う目的として最も適切なのはどれですか？',
  options = ARRAY[
    'コストを最も楽観的に見積もり、予算を最小化することで、プロジェクトの承認を得やすくする',
    '最頻値（Most Likely）、楽観値（Optimistic）、悲観値（Pessimistic）の3つを考慮し、不確実性を反映した期待値を算出する',
    '3人の専門家の意見を平均し、個人の偏りを排除する',
    '過去3件のプロジェクトの実績平均を取ることで、現実的な見積もりを得る'
  ],
  correct_answer = ARRAY['最頻値（Most Likely）、楽観値（Optimistic）、悲観値（Pessimistic）の3つを考慮し、不確実性を反映した期待値を算出する'],
  explanation = 'Aの楽観的見積もりは、後で予算超過を招き、プロジェクトの信頼を損ないます。Cは「デルファイ法」の説明であり、三点見積もりとは異なります。Dは過去実績平均であり、三点見積もりではありません。Bが正解で、三点見積もり（PERT見積もり）は、不確実性の高いタスクで、①楽観値（最良のケース）、②最頻値（最も起こりやすい）、③悲観値（最悪のケース）の3つを見積もり、重み付け平均（期待値 = (O + 4M + P)/6）を計算します。これにより、単一値見積もりより現実的で、リスクを反映した見積もりが得られます。'
WHERE lesson_id = 18 AND "order" = 2;

UPDATE questions SET
  question = 'コストベースラインに対し実コストが超過している場合、最も適切な対応はどれですか？',
  options = ARRAY[
    '超過を隠蔽し、プロジェクト終了後に一括報告する',
    'コスト超過の原因を分析し、是正措置（スコープ削減、効率化等）を実施、ステークホルダーに報告する',
    '品質基準を緩和し、検査を省略してコストを削減する',
    'すべてのコスト超過を予備費から充当し、問題ないこととする'
  ],
  correct_answer = ARRAY['コスト超過の原因を分析し、是正措置（スコープ削減、効率化等）を実施、ステークホルダーに報告する'],
  explanation = 'Aの隠蔽は、問題が悪化し、後で発覚すれば信頼を失います。Cの品質緩和は、品質不良を生み、後の瑕疵対応でさらにコスト増になります。Dの予備費充当は一時的対処であり、根本原因を放置すれば予備費も枯渇します。Bが正解で、コスト超過への対応は、①原因分析（なぜ超過したか）、②是正措置（効率化、スコープ調整、リソース見直し）、③ステークホルダーへの透明な報告、④変更要求の提出（必要に応じてベースライン変更）、という手順です。コストマネジメントの鉄則は「早期発見・早期対処・透明性」です。'
WHERE lesson_id = 18 AND "order" = 3;

-- レッスン5: リスク分析と対応計画
UPDATE questions SET
  question = 'リスク対応戦略で「回避」「転嫁」「軽減」「受容」のうち、最もコストがかかる可能性が高いのはどれですか？',
  options = ARRAY[
    '回避: リスクを完全に排除する（例: 危険な工法を使わない）',
    '転嫁: リスクを第三者に移す（例: 保険加入、外注）',
    '軽減: 発生確率または影響度を下げる（例: 冗長化、テスト強化）',
    '受容: リスクを受け入れ、発生時に対処する（例: コンティンジェンシー予備費確保）'
  ],
  correct_answer = ARRAY['回避: リスクを完全に排除する（例: 危険な工法を使わない）'],
  explanation = 'B（転嫁）は保険料・外注費がかかりますが、リスク発生時の損失を考えれば合理的です。C（軽減）は対策コストがかかりますが、完全排除ではないため回避より安価です。D（受容）は事前コストは最小（予備費のみ）ですが、発生時のコストは大きい可能性があります。Aが正解で、回避は「リスクを完全に排除」するため、①別の工法・技術への変更、②プロジェクト計画の大幅見直し、③機会損失、などで最もコストがかかる可能性が高いです。ただし、影響度が極めて大きいリスク（人命に関わる等）は、コストをかけても回避すべきです。リスク対応は「リスクレベルとコストのバランス」で決定します。'
WHERE lesson_id = 19 AND "order" = 1;

UPDATE questions SET
  question = 'リスク登録簿に記録すべき情報として適切なものはどれですか？（複数選択）',
  options = ARRAY[
    'リスクの内容、発生確率、影響度、リスクレベル（発生確率×影響度）',
    'リスクオーナー（対応責任者）、対応戦略（回避・転嫁・軽減・受容）',
    'リスク対応のコスト見積もりと、対応後の残留リスク',
    'プロジェクトメンバーの個人的な不安や懸念（定量化困難なもの）'
  ],
  correct_answer = ARRAY['リスクの内容、発生確率、影響度、リスクレベル（発生確率×影響度）', 'リスクオーナー（対応責任者）、対応戦略（回避・転嫁・軽減・受容）', 'リスク対応のコスト見積もりと、対応後の残留リスク'],
  explanation = 'A、B、Cが正解です。リスク登録簿には、①リスクの特定（内容、原因）、②リスク分析（発生確率、影響度、リスクレベル）、③リスク対応（戦略、オーナー、コスト、スケジュール）、④残留リスク、を記録します。Dは誤りで、個人的な不安は「定量化・対応可能なリスク」として整理してから登録すべきです。リスク登録簿の目的は「リスクの体系的管理」であり、曖昧な情報ではなく、対応可能な形で記録します。'
WHERE lesson_id = 19 AND "order" = 2;

UPDATE questions SET
  question = 'リスクのモニタリングで「トリガー」を設定する目的として最も適切なのはどれですか？',
  options = ARRAY[
    'リスクが発生したことを事後的に記録し、報告書に残すため',
    'リスクが顕在化する前兆（兆候）を早期に検知し、事前に対応措置を発動するため',
    'リスク対応のコストを削減し、予算を圧縮するため',
    'プロジェクトマネージャーの権限を強化し、迅速な意思決定を可能にするため'
  ],
  correct_answer = ARRAY['リスクが顕在化する前兆（兆候）を早期に検知し、事前に対応措置を発動するため'],
  explanation = 'Aの事後記録は、リスク発生後であり、トリガーの目的ではありません（トリガーは事前検知）。Cのコスト削減、Dの権限強化は、トリガーの本来の目的ではありません。Bが正解で、トリガー（Trigger: 引き金）は「リスクが顕在化する前兆・兆候」を示す指標です。例えば、「主要メンバーの退職リスク」に対し、「不満の兆候（残業時間急増、欠勤増加）」をトリガーとして設定し、トリガーが検知されたら事前に対応（面談、業務調整）します。トリガーの目的は「早期警戒システム」であり、事後対処ではなく予防です。'
WHERE lesson_id = 19 AND "order" = 3;

-- レッスン6: コミュニケーション計画と報告
UPDATE questions SET
  question = 'コミュニケーションマネジメント計画で「プッシュ型」「プル型」「対話型」のうち、最も情報の確実性が高いのはどれですか？',
  options = ARRAY[
    'プッシュ型: 情報を相手に送付する（メール、レポート配布）',
    'プル型: 情報を格納し、相手が必要時に取得する（ポータルサイト、共有フォルダ）',
    '対話型: 相手と直接対話し、即座にフィードバックを得る（会議、電話、対面）',
    'すべて同じで、情報の確実性に差はない'
  ],
  correct_answer = ARRAY['対話型: 相手と直接対話し、即座にフィードバックを得る（会議、電話、対面）'],
  explanation = 'Aのプッシュ型は、情報を送付しますが、相手が読んだか・理解したかは不明です。Bのプル型は、相手が取得しに来ない可能性があり、最も不確実です。Dは誤りで、確実性に明確な差があります。Cが正解で、対話型（Interactive Communication）は、相手と直接対話し、即座に質問・回答・確認ができるため、情報の確実性が最も高いです。重要な情報（変更通知、リスク報告等）は対話型を優先すべきです。ただし、対話型は時間がかかるため、定型情報はプッシュ型、参照情報はプル型と使い分けます。'
WHERE lesson_id = 20 AND "order" = 1;

UPDATE questions SET
  question = 'ステークホルダーへの進捗報告で最も重要なのはどれですか？',
  options = ARRAY[
    '詳細な技術情報を網羅的に記載し、専門性の高さを示す',
    'ステークホルダーの関心事項（スコープ、スケジュール、コスト、品質、リスク）に焦点を当て、現状・課題・対策を簡潔に伝える',
    '問題を隠し、常に「順調です」と報告して安心させる',
    '報告書のページ数を増やし、作業量の多さをアピールする'
  ],
  correct_answer = ARRAY['ステークホルダーの関心事項（スコープ、スケジュール、コスト、品質、リスク）に焦点を当て、現状・課題・対策を簡潔に伝える'],
  explanation = 'Aの詳細技術情報は、技術者以外のステークホルダー（経営層、顧客）には理解困難で、本質が伝わりません。Cの問題隠蔽は、信頼を失い、後で発覚すれば大問題になります。Dのページ数増加は、読む側の負担が増えるだけで、価値がありません。Bが正解で、効果的な進捗報告の原則は、①ステークホルダーの関心事項に焦点、②現状（進捗率、達成状況）、③課題（問題点）、④対策（どう対処するか）、を簡潔に伝えることです。エグゼクティブサマリー（1ページ）+ 詳細（必要に応じて）の構成が理想です。'
WHERE lesson_id = 20 AND "order" = 2;

UPDATE questions SET
  question = 'プロジェクトで「悪いニュース」をステークホルダーに報告する際の原則として最も適切なのはどれですか？',
  options = ARRAY[
    '悪いニュースは報告せず、自分たちで解決してから事後報告する',
    '悪いニュースこそ早く報告し、現状・影響・対策案を明確に伝え、支援を仰ぐ',
    '悪いニュースを報告する際は、責任者を特定し、個人の責任として処理する',
    '悪いニュースは曖昧に表現し、深刻さを薄めて伝える'
  ],
  correct_answer = ARRAY['悪いニュースこそ早く報告し、現状・影響・対策案を明確に伝え、支援を仰ぐ'],
  explanation = 'Aの報告遅延は、問題が大きくなってから発覚し、手遅れになります。Cの個人責任追及は、報告を隠す文化を生み、逆効果です。Dの曖昧表現は、ステークホルダーが深刻さを理解できず、適切な支援が得られません。Bが正解で、悪いニュース報告の鉄則は「早く、正確に、対策案付きで」です。早期報告により、ステークホルダーが代替案・追加リソース・スコープ調整等の支援を提供でき、被害を最小化できます。「悪いニュースほど早く」がプロジェクトマネジメントの原則です。'
WHERE lesson_id = 20 AND "order" = 3;

-- レッスン7: 調達マネジメント
UPDATE questions SET
  question = '調達で「一般競争入札」「指名競争入札」「随意契約」のうち、最も透明性が高い方式はどれですか？',
  options = ARRAY[
    '一般競争入札: 広く公告し、資格を満たす全ての業者が参加可能',
    '指名競争入札: 発注者が選定した複数業者に入札を依頼',
    '随意契約: 特定の業者と直接交渉して契約',
    'すべて同じで、透明性に差はない'
  ],
  correct_answer = ARRAY['一般競争入札: 広く公告し、資格を満たす全ての業者が参加可能'],
  explanation = 'Bの指名競争入札は、指名される業者が限定され、透明性はある程度ありますが、一般競争より低いです。Cの随意契約は、特定業者との直接交渉であり、透明性が最も低いです（ただし、緊急時・特殊技術等で必要な場合もあります）。Dは誤りで、透明性に明確な差があります。Aが正解で、一般競争入札は「広く公告」し「資格を満たす全業者」が参加可能であり、最も透明性が高く、公正な競争が期待できます。公共調達では原則として一般競争入札が採用されます。'
WHERE lesson_id = 21 AND "order" = 1;

UPDATE questions SET
  question = '契約形態で「固定価格契約（FP）」と「実費償還契約（CPFF）」の使い分けとして最も適切なのはどれですか？',
  options = ARRAY[
    '常に固定価格契約を選び、コストを確定させることでリスクを排除する',
    'スコープが明確で変動が少ない場合は固定価格契約、スコープが不確実で変動が多い場合は実費償還契約',
    '常に実費償還契約を選び、柔軟性を最大化する',
    '契約形態はプロジェクトの成否に影響しないため、どちらでも良い'
  ],
  correct_answer = ARRAY['スコープが明確で変動が少ない場合は固定価格契約、スコープが不確実で変動が多い場合は実費償還契約'],
  explanation = 'Aの常に固定価格は、スコープが不確実な場合、ベンダーが高いリスクプレミアムを上乗せするか、品質を犠牲にするリスクがあります。Cの常に実費償還は、コスト管理が困難で、ベンダーのコスト削減インセンティブが働きません。Dは誤りで、契約形態は重要です。Bが正解で、固定価格契約（FP: Fixed Price）はスコープが明確で変動が少ない場合に適し、発注者のコストリスクが低いです。実費償還契約（CPFF: Cost Plus Fixed Fee）はスコープが不確実で変動が多い場合に適し、柔軟性が高いですが、発注者がコストリスクを負います。契約形態の選択は「スコープの確実性」で判断します。'
WHERE lesson_id = 21 AND "order" = 2;

UPDATE questions SET
  question = '調達契約の終結（クローズアウト）で実施すべき活動として適切なものはどれですか？（複数選択）',
  options = ARRAY[
    '成果物の検収と受入確認、契約条件の充足確認',
    '未解決の問題・クレームの解決、支払いの完了',
    '次回契約に備え、ベンダーのパフォーマンス評価を記録',
    '契約終結後は一切の連絡を絶ち、新しいプロジェクトに集中する'
  ],
  correct_answer = ARRAY['成果物の検収と受入確認、契約条件の充足確認', '未解決の問題・クレームの解決、支払いの完了', '次回契約に備え、ベンダーのパフォーマンス評価を記録'],
  explanation = 'A、B、Cが正解です。調達契約の終結（Close Procurements）では、①成果物の検収・受入確認、②契約条件の充足確認、③未解決問題の解決、④最終支払い、⑤ベンダーパフォーマンス評価・記録、⑥契約ファイルのアーカイブ、を実施します。Dは誤りで、適切な終結プロセスを経ず、保証期間中のサポート等も考慮すべきです。契約終結の目的は「正式な完了」と「組織のプロセス資産への蓄積」です。'
WHERE lesson_id = 21 AND "order" = 3;

-- レッスン8: 変更管理と構成管理
UPDATE questions SET
  question = '変更要求が発生した際、統合変更管理委員会（CCB）が承認・却下を判断する基準として最も適切なのはどれですか？',
  options = ARRAY[
    '変更要求者の役職が高ければ自動承認、低ければ却下する',
    '変更がプロジェクト目標（スコープ、スケジュール、コスト、品質、リスク）に与える影響を総合評価し、ビジネス価値・優先度で判断する',
    'すべての変更要求を一律に承認し、柔軟性を最大化する',
    '変更のコストが低ければ承認、高ければ却下する'
  ],
  correct_answer = ARRAY['変更がプロジェクト目標（スコープ、スケジュール、コスト、品質、リスク）に与える影響を総合評価し、ビジネス価値・優先度で判断する'],
  explanation = 'Aの役職優先は、変更の実質的価値を無視しており、不合理です。Cの一律承認は、優先度の低い変更でリソースを浪費し、重要な変更が遅れます。Dのコスト基準のみは、ビジネス価値を考慮しておらず、低コストでも不要な変更を承認してしまいます。Bが正解で、CCB（Change Control Board）の判断基準は、①変更の影響評価（スコープ、スケジュール、コスト、品質、リスク）、②ビジネス価値（ROI、顧客価値）、③優先度、です。統合変更管理の本質は「価値の高い変更を選択的に承認」することです。'
WHERE lesson_id = 22 AND "order" = 1;

UPDATE questions SET
  question = '構成管理（Configuration Management）の主な目的はどれですか？',
  options = ARRAY[
    'プロジェクトのスケジュールを管理し、納期を守る',
    'プロジェクトの成果物（ドキュメント、コード等）のバージョンを管理し、変更履歴を追跡、一貫性を保つ',
    'プロジェクトのコストを管理し、予算超過を防ぐ',
    'プロジェクトチームのコミュニケーションを促進する'
  ],
  correct_answer = ARRAY['プロジェクトの成果物（ドキュメント、コード等）のバージョンを管理し、変更履歴を追跡、一貫性を保つ'],
  explanation = 'A、C、Dはそれぞれスケジュール管理、コスト管理、コミュニケーション管理の目的であり、構成管理とは異なります。Bが正解で、構成管理（Configuration Management）は、プロジェクトの成果物（要件定義書、設計書、ソースコード、テストケース等）を構成アイテム（CI: Configuration Item）として管理し、①バージョン管理、②変更履歴の追跡、③ベースラインの設定、④一貫性の保持、を実現します。これにより「どのバージョンが最新か」「誰がいつ何を変更したか」が明確になります。'
WHERE lesson_id = 22 AND "order" = 2;

UPDATE questions SET
  question = '変更管理で「ベースライン」を設定する目的として最も適切なのはどれですか？',
  options = ARRAY[
    'プロジェクトの進捗を測定する基準点を設け、変更前後の比較を可能にする',
    'プロジェクトメンバーの作業時間を記録し、給与計算の基礎とする',
    'ステークホルダーの満足度を測定し、評価する',
    'プロジェクトの予算を確定し、追加費用を一切認めないようにする'
  ],
  correct_answer = ARRAY['プロジェクトの進捗を測定する基準点を設け、変更前後の比較を可能にする'],
  explanation = 'B、Cはベースラインの目的ではありません。Dは誤りで、ベースラインは「基準点」であり、変更を禁止するものではありません（変更管理プロセスを経て変更可能）。Aが正解で、ベースライン（Baseline）は「承認された計画の特定バージョン」であり、①進捗測定の基準点、②変更前後の比較、③パフォーマンス評価、の基礎となります。スコープベースライン、スケジュールベースライン、コストベースラインがあり、変更が承認されればベースラインも更新されます。ベースラインの目的は「測定可能な基準点の設定」です。'
WHERE lesson_id = 22 AND "order" = 3;

-- レッスン9: 教訓管理と組織知識の活用
UPDATE questions SET
  question = '「教訓管理（Lessons Learned）」を効果的に実施するタイミングとして最も適切なのはどれですか？',
  options = ARRAY[
    'プロジェクト終了後にのみ実施し、すべての教訓を一度にまとめる',
    'プロジェクトの各フェーズ終了時（およびマイルストーン）に実施し、鮮度の高い教訓を即座に組織知識として蓄積する',
    'プロジェクトが失敗した場合にのみ実施し、成功したプロジェクトでは不要',
    '1年に1回、全プロジェクトの教訓をまとめて収集する'
  ],
  correct_answer = ARRAY['プロジェクトの各フェーズ終了時（およびマイルストーン）に実施し、鮮度の高い教訓を即座に組織知識として蓄積する'],
  explanation = 'Aの終了後のみは、プロジェクト進行中に他のプロジェクトが同じ失敗を繰り返すリスクがあり、また記憶が薄れて詳細が失われます。Cの失敗のみは、成功事例から学ぶ機会を逃します（成功の再現性も重要）。Dの年1回は、タイミングが遅すぎて鮮度が失われます。Bが正解で、効果的な教訓管理は「継続的・タイムリー」に実施することです。各フェーズ終了時、マイルストーン到達時に教訓を収集し、即座に組織のナレッジベースに登録することで、①鮮度の高い情報、②進行中の他プロジェクトでも活用可能、となります。'
WHERE lesson_id = 23 AND "order" = 1;

UPDATE questions SET
  question = '組織のプロセス資産（OPA: Organizational Process Assets）に含まれるものとして適切なものはどれですか？（複数選択）',
  options = ARRAY[
    '過去のプロジェクトの教訓、テンプレート、標準プロセス、ガイドライン',
    '歴史的情報（過去のプロジェクトのスケジュール・コスト実績）',
    '各プロジェクトメンバーの個人的なスキルや経験',
    'リスク登録簿、課題ログ、変更ログなどのプロジェクトドキュメント'
  ],
  correct_answer = ARRAY['過去のプロジェクトの教訓、テンプレート、標準プロセス、ガイドライン', '歴史的情報（過去のプロジェクトのスケジュール・コスト実績）', 'リスク登録簿、課題ログ、変更ログなどのプロジェクトドキュメント'],
  explanation = 'A、B、Dが正解です。組織のプロセス資産（OPA）は、①プロセス・手順・ポリシー（標準プロセス、テンプレート、ガイドライン、チェックリスト）、②組織の知識ベース（過去のプロジェクト情報、教訓、履歴データ、プロジェクトファイル）、の2つに分類されます。Cは誤りで、個人のスキル・経験は「企業環境要因（EEF: Enterprise Environmental Factors）」に分類され、OPAではありません。OPAは「組織として蓄積・共有される資産」です。'
WHERE lesson_id = 23 AND "order" = 2;

UPDATE questions SET
  question = '教訓管理で「失敗事例」を組織で共有する際、最も重要な原則はどれですか？',
  options = ARRAY[
    '失敗の責任者を明確にし、個人名を公表することで再発を防ぐ',
    '失敗を「個人の責任」ではなく「システムの問題」として扱い、ブレームレス（非難しない）で分析・共有する',
    '失敗事例は企業イメージを損なうため、社外に漏れないよう厳重に管理し、限定的に共有する',
    '失敗事例は記録せず、成功事例のみを共有してモチベーションを維持する'
  ],
  correct_answer = ARRAY['失敗を「個人の責任」ではなく「システムの問題」として扱い、ブレームレス（非難しない）で分析・共有する'],
  explanation = 'Aの個人名公表は、失敗を隠す文化を生み、逆効果です。Cの限定共有は、組織全体で学ぶ機会を失います（セキュリティに配慮しつつ、社内では広く共有すべき）。Dの記録しないは、同じ失敗を繰り返します。Bが正解で、失敗事例共有の鉄則は「ブレームレス（Blameless）」です。失敗を個人の責任追及ではなく、「なぜそのようなシステム・プロセスで失敗が起きたか」をシステムの問題として分析し、再発防止策を講じます。心理的安全性が確保され、失敗を隠さず報告する文化が醸成されます。'
WHERE lesson_id = 23 AND "order" = 3;

-- ===== 上級コース =====

-- レッスン1: ステークホルダーマネジメント（上級）
UPDATE questions SET
  question = '複雑なプロジェクトで相反する利害を持つステークホルダー（例: コスト削減を求める財務部門 vs 高品質を求める品質部門）がいる場合、最も適切な対応はどれですか？',
  options = ARRAY[
    '権力の強いステークホルダーの要求を優先し、他は無視する',
    '両者の要求を中途半端に満たし、どちらにも不満が残る妥協案を提示する',
    '両者と個別に対話し、プロジェクト目標への影響を定量的に示し、Win-Winまたは優先順位の合意を形成する',
    'プロジェクトマネージャーが独断で判断し、ステークホルダーの意見を聞かない'
  ],
  correct_answer = ARRAY['両者と個別に対話し、プロジェクト目標への影響を定量的に示し、Win-Winまたは優先順位の合意を形成する'],
  explanation = 'Aの権力優先は、他のステークホルダーの反発を招き、プロジェクトの障害になります。Bの中途半端な妥協は、どちらも満足せず、品質もコストも中途半端になります。Dの独断は、ステークホルダーの支持を失います。Cが正解で、利害対立への対応は、①個別対話で各々の真の懸念・期待を理解、②プロジェクト目標（ROI、顧客価値等）への影響を定量的に提示、③Win-Win案の探索（例: 重要機能は高品質、非重要機能はコスト優先）、④Win-Win不可能なら優先順位の合意形成、です。ステークホルダーマネジメントの本質は「対話と合意形成」です。'
WHERE lesson_id = 3 AND "order" = 1;

UPDATE questions SET
  question = 'プロジェクトスポンサー（上級役員）が突然交代し、新スポンサーがプロジェクトに懐疑的な場合、最も適切な対応はどれですか？',
  options = ARRAY[
    '新スポンサーの意向を無視し、前スポンサーの承認を根拠にプロジェクトを継続する',
    '新スポンサーと早急に面談し、プロジェクトの目的・価値・進捗・リスクを説明、懸念を聴取し、信頼関係を構築する',
    '新スポンサーが反対するなら、プロジェクトを即座に中止する',
    '新スポンサーには何も報告せず、プロジェクトを水面下で継続する'
  ],
  correct_answer = ARRAY['新スポンサーと早急に面談し、プロジェクトの目的・価値・進捗・リスクを説明、懸念を聴取し、信頼関係を構築する'],
  explanation = 'Aの無視は、新スポンサーがプロジェクトを中止する可能性があります。Cの即座中止は、プロジェクトの価値を説明する機会を放棄しています。Dの水面下継続は、後で発覚すれば信頼を完全に失います。Bが正解で、スポンサー交代への対応は、①早急に面談をセット、②プロジェクトの目的・ビジネス価値を説明（Why）、③現在の進捗・成果を提示、④リスクと対策を透明に共有、⑤新スポンサーの懸念を聴取・対応、⑥信頼関係の構築、です。新スポンサーの懐疑は「情報不足」が原因の場合が多く、丁寧な説明で理解を得られることが多いです。'
WHERE lesson_id = 3 AND "order" = 2;

UPDATE questions SET
  question = 'ステークホルダーの「隠れた意図（Hidden Agenda）」を把握するために有効な手法はどれですか？（複数選択）',
  options = ARRAY[
    '1on1の非公式な対話を通じて、公式の場では言えない本音を聴取する',
    'ステークホルダーの過去の行動パターン・意思決定履歴を分析し、価値観を推測する',
    'ステークホルダー登録簿に記載された情報のみを信じ、それ以上は詮索しない',
    '他のステークホルダーからの情報（評判、関係性）を収集し、多角的に理解する'
  ],
  correct_answer = ARRAY['1on1の非公式な対話を通じて、公式の場では言えない本音を聴取する', 'ステークホルダーの過去の行動パターン・意思決定履歴を分析し、価値観を推測する', '他のステークホルダーからの情報（評判、関係性）を収集し、多角的に理解する'],
  explanation = 'A、B、Dが正解です。隠れた意図（Hidden Agenda: 公には言わないが実際に重視している目的）を把握するには、①非公式な対話（公式会議では本音が出にくい）、②過去の行動分析（何を優先してきたか）、③多角的な情報収集（他者の評価、組織内の人間関係）、が有効です。Cは誤りで、登録簿は公式情報であり、隠れた意図は記載されていません。高度なステークホルダーマネジメントでは、表面的な情報だけでなく、深層の動機を理解することが重要です。'
WHERE lesson_id = 3 AND "order" = 999;

-- レッスン2: リスクマネジメント（上級）
UPDATE questions SET
  question = 'プロジェクトで「ブラックスワン（Black Swan）」と呼ばれる予測困難な極端なリスクへの対応として最も適切なのはどれですか？',
  options = ARRAY[
    'ブラックスワンは予測不可能なため、対応は不要とする',
    'すべての極端なリスクを網羅的にリスト化し、個別に対応計画を立てる',
    'プロジェクトの回復力（レジリエンス）を高め、予期せぬ事態が発生しても柔軟に対応できる体制・文化を構築する',
    'ブラックスワンのリスクを回避するため、プロジェクトを中止する'
  ],
  correct_answer = ARRAY['プロジェクトの回復力（レジリエンス）を高め、予期せぬ事態が発生しても柔軟に対応できる体制・文化を構築する'],
  explanation = 'Aの対応不要は無責任で、発生時に壊滅的影響を受けます。Bの網羅的リスト化は、予測困難なブラックスワンの性質上、不可能かつ非効率です。Dのプロジェクト中止は、過剰反応です。Cが正解で、ブラックスワン（予測困難な極端リスク: パンデミック、大災害等）への対応は、①個別予測ではなく「回復力（レジリエンス）」の構築、②柔軟な対応体制（代替案、バックアッププラン）、③心理的安全性（迅速な情報共有・意思決定）、④コンティンジェンシー予備費、です。レジリエンスの高い組織は、予期せぬ事態にも適応できます。'
WHERE lesson_id = 4 AND "order" = 1;

UPDATE questions SET
  question = 'リスクの「二次リスク（Secondary Risk）」と「残留リスク（Residual Risk）」の違いとして最も適切なのはどれですか？',
  options = ARRAY[
    '二次リスクは対応策の実施により新たに発生するリスク、残留リスクは対応後も残るリスク',
    '二次リスクと残留リスクは同じ意味で、どちらも対応後に残るリスクを指す',
    '二次リスクは影響度の低いリスク、残留リスクは影響度の高いリスク',
    '二次リスクはプロジェクト外部のリスク、残留リスクはプロジェクト内部のリスク'
  ],
  correct_answer = ARRAY['二次リスクは対応策の実施により新たに発生するリスク、残留リスクは対応後も残るリスク'],
  explanation = 'B、C、Dは誤った説明です。Aが正解で、二次リスク（Secondary Risk）は「リスク対応策の実施により新たに発生するリスク」です。例: 主要リスク「納期遅延」→対応「人員増強」→二次リスク「コスト超過、コミュニケーション複雑化」。残留リスク（Residual Risk）は「リスク対応後も残る、受容可能なレベルのリスク」です。例: 「墜落リスク」→対応「安全帯使用」→残留リスク「安全帯の誤使用による小さな残留リスク（受容）」。両方を認識し、管理することが重要です。'
WHERE lesson_id = 4 AND "order" = 2;

UPDATE questions SET
  question = 'モンテカルロシミュレーションをリスク分析で使用する目的として最も適切なのはどれですか？',
  options = ARRAY[
    'ステークホルダーの権力と関心を分析し、関与戦略を決定する',
    'プロジェクトのスケジュール・コストの不確実性を定量的に分析し、確率分布（例: 80%の確率で予算○○以内）を算出する',
    'チームメンバーのスキルマトリクスを作成し、能力を評価する',
    'プロジェクトの品質基準を設定し、検査方法を決定する'
  ],
  correct_answer = ARRAY['プロジェクトのスケジュール・コストの不確実性を定量的に分析し、確率分布（例: 80%の確率で予算○○以内）を算出する'],
  explanation = 'A、C、Dはモンテカルロシミュレーションとは無関係です。Bが正解で、モンテカルロシミュレーションは、①各タスクのスケジュール・コストに不確実性（楽観値、最頻値、悲観値）を設定、②何千回もランダムにシミュレーション、③確率分布を算出（例: 「50%の確率で100日以内、80%の確率で120日以内」）、という手法です。これにより、単一値見積もりより現実的で、リスクを反映した予測が可能になります。定量的リスク分析の代表的手法です。'
WHERE lesson_id = 4 AND "order" = 999;
